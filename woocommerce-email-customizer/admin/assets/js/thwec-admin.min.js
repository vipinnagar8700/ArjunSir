function thwecSetupEnhancedMultiSelectWithValue(elm){thwec_base.setupEnhancedMultiSelectWithValue(elm)}function thwecSetupSortableTable(parent,elm,left){thwec_base.setupSortableTable(parent,elm,left)}function thwecSetupPopupTabs(parent,elm,left){thwec_base.setupPopupTabs(parent,elm,left)}function thwecOpenFormTab(elm,tab_id,form_type){thwec_base.openFormTab(elm,tab_id,form_type)}function thwec_setup_color_picker(form){thwec_base.setupColorPicker(form)}function thwecBuilderBlockEdit(elm,blockId,blockName){thwec_tbuilder.open_builder_block_edit_sidebar(elm,blockId,blockName)}function thwecClearTemplateBuilder(elm){thwec_tbuilder.clear_tbuilder(elm)}function thwecBuilderBlockDelete(elm){thwec_tbuilder.builder_block_delete(elm)}function thwecBuilderBlockClone(elm){thwec_tbuilder.confirm_builder_block_clone(elm)}function thwecImageUploader(elm,prop){thwec_tbuilder.setup_image_uploader(elm,prop)}function thwecTActionAddRow(elm){thwec_tbuilder.template_action_add_row(elm)}function thwecSidebarNavigateBack(elm){thwec_tbuilder.template_sidebar_nav_back(elm)}function thwecCategoryCollapse(elm){thwec_tbuilder.setup_category_toggle_functions(elm)}function thwecRemoveUploadedImg(elm){thwec_tbuilder.remove_uploaded_image(elm)}function thwecSaveAdditionalCss(elm){thwec_tbuilder.save_additional_css(elm)}function thwecNewTemplate(elm){thwec_settings.create_new_template(elm)}function thwecInitiateTemplateSave(elm){thwec_settings.initiateTemplateSave(elm,!1,!0)}function thwecPreviewTemplate(elm){thwec_settings.show_template_preview(elm)}function editTemplateChangeListner(elm){thwec_settings.edit_template_change_listner(elm)}function thwecTemplateMapValidation(elm){thwec_settings.template_map_validation(elm)}function thwecOpenModal(elm,flag){thwec_settings.open_modal(elm,flag)}function thwecCloseModal(elm){thwec_settings.close_modal(elm)}function thwecSaveTemplateEvent(elm){thwec_settings.save_template_event(elm)}function thwecEditTN(elm){thwec_settings.edit_template_name(elm)}function thwecMapFormToggle(elm){thwec_settings.map_form_toggle(elm)}function thwecSendTestMail(elm){thwec_settings.send_test_mail(elm)}function thwecBuilderPreviewTab(elm){thwec_settings.toggle_builder_preview_tab(elm)}function thwecDeleteTemplate(elm){thwec_settings.delete_template(elm)}var thwec_base=function($,window,document){"use strict";function escapeHTML(html){var fn=function(tag){return{'"':"&quot;","'":"&#39;"}[tag]||tag};return html.replace(/[&<>"]/g,fn)}function removeHTML(html){return html.replace(/[&<>"]/g,"")}function decodeHTML(html){return html.replace(/'/g,"&#39;").replace(/"/g,"&quot;")}function isHtmlIdValid(id){return/^[a-z\_]+[a-z0-9\_]*$/.test(id.trim())}function isCssValid(property,value){var div=$("<div>"),_old=div.css(property);return div.css(property,value),_old!=div.css(property)}function isValidHexColor(value){return!!preg_match("/^#[a-f0-9]{6}$/i",value)}function setup_tiptip_tooltips(){var tiptip_args={attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200};$(".tips").tipTip(tiptip_args)}function setup_enhanced_multi_select(parent){parent.find("select.thwec-enhanced-multi-select").each(function(){$(this).hasClass("enhanced")||$(this).select2({minimumResultsForSearch:10,allowClear:!0,placeholder:$(this).data("placeholder")}).addClass("enhanced")})}function setup_enhanced_multi_select_with_value(parent){parent.find("select.thwec-enhanced-multi-select").each(function(){if(!$(this).hasClass("enhanced")){$(this).select2({minimumResultsForSearch:10,allowClear:!0,placeholder:$(this).data("placeholder")}).addClass("enhanced");var value=$(this).data("value");value=value.split(","),$(this).val(value),$(this).trigger("change")}})}function setup_color_picker(form){form.find(".thpladmin-colorpick").iris({change:function(event,ui){var input=$(this);input.parent().find(".thpladmin-colorpickpreview").css({backgroundColor:ui.color.toString()}),input.val(ui.color.toString()),input.trigger("keyup")},hide:!0,border:!0}).click(function(){$(".iris-picker").hide(),$(this).closest("td").find(".iris-picker").show()}),$("body").click(function(){$(".iris-picker").hide()}),$(".thpladmin-colorpick").click(function(event){event.stopPropagation()})}function setup_color_pick_preview(form){form.find(".thpladmin-colorpick").each(function(){$(this).parent().find(".thpladmin-colorpickpreview").css({backgroundColor:this.value})})}function setup_popup_tabs(form,selector_prefix){$("."+selector_prefix+"-tabs-menu a").click(function(event){event.preventDefault(),$(this).parent().addClass("current"),$(this).parent().siblings().removeClass("current");var tab=$(this).attr("href");$("."+selector_prefix+"-tab-content").not(tab).css("display","none"),$(tab).fadeIn()})}function prepare_field_order_indexes(elm){$(elm+" tbody tr").each(function(index,el){$("input.f_order",el).val(parseInt($(el).index(elm+" tbody tr")))})}function setup_sortable_table(parent,elm,left){parent.find(elm+" tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,helper:function(e,ui){return ui.children().each(function(){$(this).width($(this).width())}),ui.css("left",left),ui}}),$(elm+" tbody").on("sortstart",function(event,ui){ui.item.css("background-color","#f6f6f6")}),$(elm+" tbody").on("sortstop",function(event,ui){ui.item.removeAttr("style"),prepare_field_order_indexes(elm)})}function get_property_field_value(field){var value="";return value=field.val(),value=null==value?"":value}function get_form_field_value(field,type){var value="";switch(type){case"select":case"textarea":default:value=field.val(),value=null==value?"":value;break;case"checkbox":value=field.prop("checked"),value=value?1:0}return value}function get_property_field_value(form,type,name){var value="";switch(type){case"select":value=form.find("select[name=i_"+name+"]").val(),value=null==value?"":value;break;case"checkbox":value=form.find("input[name=i_"+name+"]").prop("checked"),value=value?1:0;break;case"textarea":value=form.find("textarea[name=i_"+name+"]").val(),value=null==value?"":value;break;default:value=form.find("input[name=i_"+name+"]").val(),value=null==value?"":value}return value}function set_property_field_value(form,type,name,value,multiple){switch(type){case"select":1==multiple&&"string"==typeof value&&(value=value.split(","),name+="[]"),form.find('select[name="i_'+name+'"]').val(value);break;case"checkbox":value=1==value,form.find("input[name=i_"+name+"]").prop("checked",value);break;case"textarea":form.find("textarea[name=i_"+name+"]").val(value);break;default:form.find("input[name=i_"+name+"]").val(value)}}return{escapeHTML:escapeHTML,decodeHTML:decodeHTML,removeHTML:removeHTML,isHtmlIdValid:isHtmlIdValid,isCssValid:isCssValid,isValidHexColor:isValidHexColor,setup_tiptip_tooltips:setup_tiptip_tooltips,setupEnhancedMultiSelect:setup_enhanced_multi_select,setupEnhancedMultiSelectWithValue:setup_enhanced_multi_select_with_value,setupColorPicker:setup_color_picker,setup_color_pick_preview:setup_color_pick_preview,setupSortableTable:setup_sortable_table,setupPopupTabs:setup_popup_tabs,get_form_field_value:get_form_field_value,get_property_field_value:get_property_field_value,set_property_field_value:set_property_field_value}}(window.jQuery,window,document),thwec_tbuilder=function($,window,document){"use strict";function initialize_tbuilder(){preview_wrapper=$("#thwec_tbuilder_editor_preview"),setup_sidebar_builder_clicks(),setup_confirmation_alerts(),setup_template_builder(),body_resize_sidebar_scroll(),$(".thwec-tbuilder-elm-wrapper").on("click",".column-name",function(event){$(this).closest(".columns").find(".element-set").toggle()}),$(".thwec-tbuilder-elm-wrapper").on("click",".row-name",function(event){$(this).closest(".rows").find(".column-set").toggle(),$(this).closest(".rows").toggleClass("rows-collpase")}),$(".thwec-tbuilder-header-panel").on("blur","input",function(){""!=$(this).val()?$(this).addClass("has-value"):$(this).removeClass("has-value")}),$("#thwec-sidebar-settings").on("keyup","form :input",function(event){save_sidebar_form_onchange($(this),event)}),$("#thwec-sidebar-settings").on("change","select",function(event){save_sidebar_form_onchange($(this),event)}),$("#thwec-sidebar-settings").on("change",'input[name="i_checkbox_option_image"]',function(event){save_sidebar_form_onchange($(this),event)})}function remove_builder_panel_highlights(){$("#thwec-sidebar-configure .thwec-builder-elm-layers").find(".thwec-panel-highlight").removeClass("thwec-panel-highlight"),$("#tb_temp_builder").find(".thwec-builder-highlight").removeClass("thwec-builder-highlight")}function body_resize_sidebar_scroll(){activate_panel_wrapper_scroll(!1),$(window).on("resize",function(){var active_tab1=$("#thwec-sidebar-configure.active-tab"),active_tab2=$("#thwec-sidebar-settings.active-tab");active_tab1.length>0?activate_panel_wrapper_scroll(active_tab1):active_tab2.length>0&&activate_panel_layout_wrapper_scroll(active_tab2,!0,!0,!0)})}function activate_panel_wrapper_scroll(active_tab1){active_tab1=active_tab1||$("#thwec-sidebar-configure.active-tab");var sidebar_wrapper=$("#thwec-sidebar-element-wrapper"),height1=sidebar_wrapper.height()-55;active_tab1.find(".thwec-layers-outer-wrapper").css({height:height1})}function activate_panel_layout_wrapper_scroll(active_tab2,layout_wrapper,edit_wrapper,element_wrapper){active_tab2=active_tab2||$("#thwec-sidebar-settings.active-tab");var sidebar_wrapper=$("#thwec-sidebar-element-wrapper"),height2=sidebar_wrapper.height()-4,height3=sidebar_wrapper.height()-4;layout_wrapper&&active_tab2.find(".panel-layout-outer-wrapper").css({height:height2}),edit_wrapper&&active_tab2.find(".thwec_field_form_outer_wrapper").css({height:height3}),element_wrapper&&active_tab2.find(".outer-wrapper").css({height:height2})}function setup_category_toggle_functions(elm){var click_cat=($(elm),$(elm).closest(".grid-category"));click_cat.hasClass("category-collapse")?(click_cat.removeClass("category-collapse"),$(".thwec-tbuilder-elm-grid-layout-element").find(".grid-category").not(click_cat).each(function(index,el){$(this).addClass("category-collapse")})):click_cat.addClass("category-collapse")}function get_random_string(){var block_id=$("#tb_temp_builder").attr("data-global-id"),new_block_id=parseInt(block_id)+1;return $("#tb_"+new_block_id).length>0?get_new_random_id(new_block_id):$("#tb_temp_builder").attr("data-global-id",new_block_id),new_block_id}function get_new_random_id(new_id){var new_id=parseInt(new_id)+1;$("#tb_"+new_id).length>0?get_new_random_id(new_id):$("#tb_temp_builder").attr("data-global-id",new_id)}function get_cleaned_block_name(name){return name.replace(/_/g," ").replace(/\b[a-z]/g,function(string){return string.toUpperCase()})}function is_layout_block(name){return-1!==$.inArray(name,LAYOUT_BLOCKS)}function is_sidebar_validation_required_block(name){return-1!==$.inArray(name,SB_VALIDATION_REQ_BLOCKS)}function is_layout_column(name){return-1!==$.inArray(name,LAYOUT_COLUMNS)}function is_address_block(name){return-1!==$.inArray(name,ADDRESS_BLOCKS)}function is_hooks_features(name){return-1!==$.inArray(name,HOOK_FEATURES)}function clear_tbuilder(elm){var popup=$("#thwec_confirmation_alerts"),builder_css=$("#tb_temp_builder").attr("data-css-change");popup.find(".thwec-messages").html($("#thwec_clear_builder_confirm").html()),($(".thwec-builder-elm-layers .panel-builder-block").length>1||"false"==builder_css)&&(popup.dialog("option","buttons",[{text:"No",click:function(){$(this).dialog("close")}},{text:"Yes",click:function(){confirmation_tbuilder_clear(),$(this).dialog("close")}}]),popup.dialog("open"))}function confirmation_tbuilder_clear(){var tb_builder=$("#tb_temp_builder");tb_builder.empty(),$("div.thwec-builder-elm-layers").empty(),setup_blank_track_panel_msg(),tb_builder.attr("data-css-props",TB_DEFAULT),tb_builder.attr("data-global-id","1000"),tb_builder.attr("data-track-save","1000"),$("#thwec_template_css_override").html(""),$("#thwec_template_css_preview_override").html("")}function reset_col_width(row,columns){var siblings_props,col_width=100/parseInt(columns);$("#tb_temp_builder").find("#tb_"+row+" tbody > tr > td").each(function(index,el){var data_props=$(this).attr("data-css-props");if($(this).attr("id")){var block_id=$(this).attr("id").replace("tb_","");if(data_props)data_props=JSON.parse(data_props),siblings_props=data_props;else var data_props=BASIC_PROPS;data_props.width=col_width+"%";var data_props_json=JSON.stringify(data_props);$(this).attr("data-css-props",data_props_json),$.isEmptyObject(data_props)||$.each(data_props,function(index,val){var props={};props[index]=val,prepare_css_functions(index,props,block_id,"column_clone")})}})}function get_column_html(id){return'<td class="column-padding thwec-col thwec-columns" id="tb_'+id+'">'+BLANK_TD_DATA+"</td>"}function focus_selected_element(b_elm,p_elm,status){remove_builder_panel_highlights();var tbuilder_ref=$("#tb_temp_builder"),panel_ref=$(".thwec-sidebar-config-elm-layers");tbuilder_ref.find(".thwec-builder-highlight").removeClass("thwec-builder-highlight"),panel_ref.find(".thwec-panel-highlight").removeClass("thwec-panel-highlight"),p_elm.addClass("thwec-panel-highlight"),b_elm.addClass("thwec-builder-highlight"),$("html, body").animate({scrollTop:get_element_position_b(b_elm)},500);var p_container=$(".thwec-layers-outer-wrapper");p_container.animate({scrollTop:get_element_position_p(p_elm,p_container)},500),setTimeout(function(){p_elm.removeClass("thwec-panel-highlight"),b_elm.removeClass("thwec-builder-highlight")},3e3)}function get_element_position_b(elm){return parseInt(elm.offset().top)-200}function get_element_position_p(elm,container){return parseInt(elm.offset().top-container.offset().top+container.scrollTop())-200}function prepare_css(props){var css="";return $.each(props,function(name,css_prop){if(name in CSS_PROPS){var css_pname=CSS_PROPS[name].name;css_prop=css_prop||DEFAULT_CSS[css_pname],css_prop&&(css+=css_pname+":"+css_prop+";")}}),css}function get_css_parent_selector(blockId,isPrev){var p_selector="#"+blockId;return isPrev?p_selector:p_selector+" "}function template_action_add_row(elm){change_sidebar_status(!1);setup_sidebar_general("layout"),activate_panel_layout_wrapper_scroll(!1,!0,!1,!1)}function builder_block_delete(elm){if($(elm).closest("div.panel-builder-block").hasClass("hooks")){var id=$(elm).closest("div.panel-builder-block").attr("id");$(elm).closest("div.panel-builder-block").remove();var block=$("#tb_temp_builder").find("#tb_"+id),block_parent=block.closest(".thwec-columns");block.remove(),block_parent.find(".builder-block").length<1&&block_parent.find(".hook-code").length<1&&block_parent.html(BLANK_TD_DATA)}else{var select_block=$(elm).closest("div.panel-builder-block"),delete_panel_elm=select_block,delete_id=select_block.attr("id"),builder_element=$("#tb_temp_builder").find("#tb_"+delete_id),panel_element=$("div.thwec-builder-elm-layers").find("#"+delete_id);if(delete_panel_elm.hasClass("rows")||delete_panel_elm.hasClass("elements")){var builder_element_parent=builder_element.closest(".thwec-columns");builder_element.remove(),panel_element.remove(),builder_element_parent.find(".builder-block").length<1&&builder_element_parent.find(".hook-code").length<1&&builder_element_parent.html(BLANK_TD_DATA)}else if(delete_panel_elm.hasClass("columns")){var builder_element_parent=builder_element.closest(".thwec-row"),panel_element_parent=panel_element.closest(".rows"),columns=panel_element_parent.attr("data-columns");if(columns<=1)builder_element_parent.remove(),panel_element_parent.remove();else{var updated_columns=parseInt(columns)-1;panel_element_parent.attr("data-columns",updated_columns),builder_element_parent.attr("data-column-count",updated_columns),builder_element.remove(),panel_element.remove();var builder_element_parent_id=builder_element_parent.attr("id").replace("tb_","");reset_col_width(builder_element_parent_id,updated_columns)}}}$("#tb_temp_builder").attr("data-sidebar-change","false"),setup_blank_track_panel_msg()}function open_builder_block_edit_sidebar(elm,blockId,blockName){setup_sidebar_general("settings"),setup_settings_form_edit($("#thwec-sidebar-settings"),blockId,blockName),change_sidebar_status(!1);var form=$("#thwec-sidebar-settings").find("form");if(thwec_base.set_property_field_value(form,"hidden","block_id",blockId,0),thwec_base.set_property_field_value(form,"hidden","block_name",blockName,0),thwec_base.setupColorPicker(form),thwec_base.setup_color_pick_preview(form),thwec_base.setup_tiptip_tooltips(),setup_additional_field_styles(form),"temp_builder"==blockName){WECM_CM=wp.codeEditor.initialize($(".additional_css"),thwec_var.cm_settings);var add_css=$("#thwec_template_css_additional_css");add_css.length&&""!=$.trim(add_css.html())&&WECM_CM.codemirror.setValue($.trim(add_css.html()))}activate_panel_layout_wrapper_scroll(!1,!1,!0,!1)}function setup_additional_field_styles(form){form.find(".thwec-aligment-icon-wrapper").each(function(index,el){var icon_val=$(this).find('input[type="hidden"]').val();$(this).find(".img-wrapper[data-align='"+icon_val+"']").addClass("thwec-active-icon")})}function setup_settings_form_edit(content,blockId,blockName){var form=$("#thwec-sidebar-settings").find("form");is_layout_block(blockName)?content.find(".thwec_field_form_general td").html($("#thwec_field_form_id_row").html()):is_layout_column(blockName)?content.find(".thwec_field_form_general td").html($("#thwec_field_form_id_col").html()):content.find(".thwec_field_form_general td").html($("#thwec_field_form_id_"+blockName).html()),remove_builder_panel_highlights(),populate_builder_block_form_general(form,blockId,blockName)}function thwec_clean_textarea_content(text){return text.replace(/&#39;/g,"'").replace(/&quot;/g,'"')}function populate_builder_block_form_general(form,blockId,blockName){var ref_elem=$("#tb_"+blockId),block_props_json=ref_elem.attr("data-css-props"),block_props=!!block_props_json&&JSON.parse(block_props_json),url_props_json=ref_elem.attr("data-text-props"),url_props=url_props_json?JSON.parse(url_props_json):"",default_upload_url=form.find(".thwec-upload-preview").attr("data-default-url"),def_vals=get_default_form_values(blockName);block_props&&!$.isEmptyObject(block_props)?$.each(block_props,function(key,value){if("img_comp_width"!=key&&"img_comp_height"!=key){var props=ELM_BLOCK_FORM_PROPS[key];ELM_BLOCK_FORM_PROPS[key].attribute&&"yes"==ELM_BLOCK_FORM_PROPS[key].attribute&&(key in VISIBLE_OPTIONS?(value="inline-block"==value&&"upload_img_url"==key&&"header_details"==blockName?VISIBLE_OPTIONS[key][blockName].css:value,value="inline-block"==value&&"upload_img_url"==key&&"image"==blockName?VISIBLE_OPTIONS[key][blockName].css:value,value="inline-block"==value&&"social"==blockName?VISIBLE_OPTIONS[key].css:value,value="image"==blockName||"gif"==blockName||"header_details"==blockName?value==VISIBLE_OPTIONS[key][blockName].css?url_props[key]:"":value==VISIBLE_OPTIONS[key].css?url_props[key]:""):value=url_props[key],"textarea_content"==key&&(value=thwec_clean_textarea_content(url_props[key]))),-1!=$.inArray(key,IMG_CSS)?value=""!=value&&value!==default_upload_url&&value.match(/\((.*)\)/)[1]:"product_img"==key&&(value="block"==value?1:0),"fourside"==props.type&&(props.type="text"),"upload_img_url"==key&&(value=""==value?default_upload_url:value,form.find(".img-preview-image .thwec-upload-preview img").attr("src",value),value!=default_upload_url&&form.find(".img-preview-"+blockName+" .remove-upload-btn").removeClass("remove-upload-inactive"),form.find(".img-preview-"+blockName+" .thwec-upload-preview img").attr("src",value)),"upload_bg_url"==key&&(0!=value?form.find(".img-preview-bg_image .remove-upload-btn").removeClass("remove-upload-inactive"):value=default_upload_url,form.find(".img-preview-bg_image .thwec-upload-preview img").attr("src",value)),"font_family"!=key&&"details_font_family"!=key||$.each(FONT_LIST,function(key,valueObj){valueObj==value&&(value=key)}),""==value&&""!=def_vals&&key in def_vals&&(value=def_vals[key]),thwec_base.set_property_field_value(form,props.type,props.name,value,0)}}):$.isEmptyObject(block_props)&&"custom_hook"==blockName&&""!=url_props&&$.each(url_props,function(key,value){if(ELM_BLOCK_FORM_PROPS[key]){var props=ELM_BLOCK_FORM_PROPS[key];thwec_base.set_property_field_value(form,props.type,props.name,value,0)}})}function get_default_form_values(blockName){var default_values={};switch(blockName){case"one_column":case"two_column":case"three_column":case"four_column":default_values={p_t:"0px",p_r:"0px",p_b:"0px",p_l:"0px",m_t:"0px",m_r:"auto",m_b:"0px",m_l:"auto",b_t:"0px",b_r:"0px",b_b:"0px",b_l:"0px",border_spacing:"0px",bg_size:"100%",bg_position:"center"};break;case"one_column_one":default_values={width:"100%",b_t:"1px",b_r:"1px",b_b:"1px",b_l:"1px",border_style:"dotted"};break;case"two_column_one":case"two_column_two":default_values={width:"50%",b_t:"1px",b_r:"1px",b_b:"1px",b_l:"1px",border_style:"dotted"};break;case"three_column_one":case"three_column_two":case"three_column_three":default_values={width:"33%",b_t:"1px",b_r:"1px",b_b:"1px",b_l:"1px",border_style:"dotted"};break;case"four_column_one":case"four_column_two":case"four_column_three":case"four_column_four":default_values={width:"25%",b_t:"1px",b_r:"1px",b_b:"1px",b_l:"1px",border_style:"dotted"};break;case"custom_hook":default_values={custom_hook_name:"custom_hook_name"};break;case"temp_builder":default_values={b_t:"1px",b_r:"1px",b_b:"1px",b_l:"1px",border_style:"solid",bg_color:"#edf1e4"};break;default:default_values=""}return default_values}function add_builder_elements(blockName,blockId,col_count){var new_id=get_random_string(),track_html=prepare_new_track_html(blockName,new_id);create_track_builder_blocks(prepare_new_block_content_html(blockName,col_count),track_html,blockId),setup_blank_track_panel_msg()}function prepare_new_track_html(blockName,row_id){if(is_layout_block(blockName)){var html='<div id="'+row_id+'" class="rows panel-builder-block" data-columns="'+COLUMN_NUMBER[blockName]+'">';LAYOUT_OBJ.row="tb_"+row_id,html+=$("#thwec_tracking_panel_row_html").html(),html=html.replace("{bl_id}",row_id),html=html.replace("{bl_name}",blockName),html=html.replace('data-icon-attr="{bl_name}"','data-icon-attr="'+blockName+'"'),html+='<div class="column-set">';for(var i=1;i<=COLUMN_NUMBER[blockName];i++){var column_id=get_random_string();LAYOUT_OBJ["column_"+i]="tb_"+column_id,html+=add_new_track_col(row_id,column_id,blockName,i)}html+='<div class="panel-add-btn btn-add-column" data-parent="'+row_id+'"><a href="#">Add Column</a></div>',html+="</div></div>"}else if(is_hooks_features(blockName)){var html=(get_cleaned_block_name(blockName),'<div id="'+row_id+'" class="hooks panel-builder-block">');html+=$("#thwec_tracking_panel_hook_html").html(),html=html.replace("{name}",get_cleaned_block_name(blockName)),html+="</div>",LAYOUT_OBJ.hook="tb_"+row_id}else{var html='<div id="'+row_id+'" class="elements panel-builder-block">';html+=$("#thwec_tracking_panel_elm_html").html(),html=html.replace("{name}",get_cleaned_block_name(blockName)),html=html.replace("{bl_id}",row_id),html=html.replace("{bl_name}",blockName),html=html.replace("{bl_attr_name}",blockName.toLowerCase()),html+="</div>;",LAYOUT_OBJ.element="tb_"+row_id}return html}function add_new_track_col(row_id,column_id,blockName,i){var column_name=blockName+"_"+NUMBER_TO_WORDS[i];is_layout_column(column_name)||(column_name="column_clone");var t_html='<div id="'+column_id+'" class="columns panel-builder-block" data-parent="'+row_id+'">';return t_html+=$("#thwec_tracking_panel_col_html").html(),t_html=t_html.replace("{bl_id}",column_id),t_html=t_html.replace("{bl_name}",column_name),t_html=t_html.replace('data-icon-attr="{bl_name}"','data-icon-attr="'+column_name+'"'),t_html+='<div class="element-set">',t_html+='<div class="thwec-hidden-sortable elements"></div><div class="btn-add-element panel-add-btn panel-add-element"><a href="#">Add Element</a></div>',t_html+="</div></div>"}function setup_blank_track_panel_msg(){$("div.thwec-builder-elm-layers").find(".rows").length<1?$(".thwec-empty-layer-msg").removeClass("thwec-layers-toggle"):$(".thwec-empty-layer-msg").addClass("thwec-layers-toggle")}function create_track_builder_blocks(builder_html,track_html,blockId){if(blockId){var id="tb_"+blockId;$(track_html).insertBefore($("div.thwec-builder-elm-layers").find("#"+blockId+" > .element-set > div.panel-add-element"));var target=$("#tb_temp_builder").find("#"+id);target.find(">.btn-add-element").length>0&&target.find(">.btn-add-element").remove(),target.append(builder_html)}else $("div.thwec-builder-elm-layers").append(track_html),$("#tb_temp_builder .thwec-builder-column").append(builder_html)}function prepare_new_block_content_html(blockName,col_count){var block_elm="",elm_type="";"one_column"==blockName?(block_elm=$("#thwec_template_layout_1_col"),elm_type="layout"):"two_column"==blockName?(block_elm=$("#thwec_template_layout_2_col"),elm_type="layout"):"three_column"==blockName?(block_elm=$("#thwec_template_layout_3_col"),elm_type="layout"):"four_column"==blockName?(block_elm=$("#thwec_template_layout_4_col"),elm_type="layout"):"left-large-column"==blockName?(block_elm=$("#thwec_template_layout_left_large_col"),elm_type="layout"):"right-large-column"==blockName?(block_elm=$("#thwec_template_layout_right_large_col"),elm_type="layout"):"gallery-column"==blockName?(block_elm=$("#thwec_template_layout_gallery_col"),elm_type="layout"):"header_details"==blockName?(block_elm=$("#thwec_template_elm_header"),elm_type="block"):"footer_details"==blockName?(block_elm=$("#thwec_template_elm_footer"),elm_type="block"):"customer_address"==blockName?(block_elm=$("#thwec_template_elm_customer_address"),elm_type="block"):"order_details"==blockName?(block_elm=$("#thwec_template_elm_order_details"),elm_type="block"):"billing_address"==blockName?(block_elm=$("#thwec_template_elm_billing_address"),elm_type="block"):"shipping_address"==blockName?(block_elm=$("#thwec_template_elm_shipping_address"),elm_type="block"):"text"==blockName?(block_elm=$("#thwec_template_elm_text"),elm_type="block"):"image"==blockName?(block_elm=$("#thwec_template_elm_image"),elm_type="block"):"social"==blockName?(block_elm=$("#thwec_template_elm_social"),elm_type="block"):"button"==blockName?(block_elm=$("#thwec_template_elm_button"),elm_type="block"):"divider"==blockName?(block_elm=$("#thwec_template_elm_divider"),elm_type="block"):"gap"==blockName?(block_elm=$("#thwec_template_elm_gap"),elm_type="block"):"gif"==blockName?(block_elm=$("#thwec_template_elm_gif"),elm_type="block"):"video"==blockName?(block_elm=$("#thwec_template_elm_video"),elm_type="block"):"email_header"==blockName?(block_elm=$("#thwec_template_hook_email_header"),elm_type="hook"):"email_order_details"==blockName?(block_elm=$("#thwec_template_hook_order_details"),elm_type="hook"):"before_order_table"==blockName?(block_elm=$("#thwec_template_hook_before_order_table"),elm_type="hook"):"after_order_table"==blockName?(block_elm=$("#thwec_template_hook_after_order_table"),elm_type="hook"):"order_meta"==blockName?(block_elm=$("#thwec_template_hook_order_meta"),elm_type="hook"):"customer_details"==blockName?(block_elm=$("#thwec_template_hook_customer_address"),elm_type="hook"):"email_footer"==blockName?(block_elm=$("#thwec_template_hook_email_footer"),elm_type="hook"):"downloadable_product"==blockName?(block_elm=$("#thwec_template_downloadable_product"),elm_type="hook"):"custom_hook"==blockName&&(block_elm=$("#thwec_template_custom_hook"),elm_type="block");var block_html="";return block_elm.length&&(block_html="layout"==elm_type?clean_block_content_layout_html(block_elm,blockName):"hook"==elm_type?clean_block_content_element_html(block_elm,blockName,"hook",!1):clean_block_content_element_html(block_elm,blockName,"element",col_count)),block_html}function clean_block_content_layout_html(block_elm,blockName){var html=block_elm.html();html=html.replace(blockName,LAYOUT_OBJ.row);for(var i=1;i<=COLUMN_NUMBER[blockName];i++){var column_name="column_"+i,replace_name=blockName+"_"+i;html=html.replace(replace_name,LAYOUT_OBJ[column_name])}return LAYOUT_OBJ={},html}function clean_block_content_element_html(block_elm,blockName,index,col_count){var html=block_elm.html();return html=html.replace("{"+blockName+"}",LAYOUT_OBJ[index]),LAYOUT_OBJ={},html}function setup_sidebar_general($active_tab){"configure"==$active_tab||("layout"==$active_tab?$("#thwec-sidebar-settings").html($("#template_builder_panel_layout").html()):"layout-elements"==$active_tab?$("#thwec-sidebar-settings").html($("#template_builder_panel_layout_element").html()):"settings"==$active_tab&&$("#thwec-sidebar-settings").html($("#thwec_builder_block_edit_form").html()))}function template_sidebar_nav_back(elm){$(elm).data("nav");change_sidebar_status(!0)}function save_additional_css(elm){WECM_CM&&(WECM_CM.codemirror.save(),save_sidebar_additional_css(elm))}function save_sidebar_additional_css(elm){var form=$(elm).closest("form"),block_id=thwec_base.get_property_field_value(form,"hidden","block_id"),block_name=thwec_base.get_property_field_value(form,"hidden","block_name"),save_block=$("#tb_"+block_id),data_json_css=save_block.attr("data-css-props"),data_json_css=save_block.attr("data-css-props");if(data_json_css=$.parseJSON(data_json_css),"temp_builder"==block_name&&thwec_var.add_css_feature&&!("additional_css"in data_json_css)){var extra_css={additional_css:""};$.extend(data_json_css,extra_css)}if(render_additional_css(thwec_base.get_property_field_value(form,"textarea","additional_css")),data_json_css){var css_json_props=JSON.stringify(data_json_css);save_block.attr("data-css-props",css_json_props)}$("#tb_"+block_id).attr("data-css-change","false"),thwec_var.save_temp_on_settings&&thwec_settings.initiateTemplateSave($("#thwec_template_save")),display_save_messages()}function render_additional_css(a_css){$("#thwec_template_css_additional_css").html(a_css)}function save_sidebar_form_onchange(field,event){var form=$("#thwec-sidebar-settings").find("form"),key=field.attr("name").replace("i_",""),block_id=thwec_base.get_property_field_value(form,"hidden","block_id"),block_name=thwec_base.get_property_field_value(form,"hidden","block_name"),additional_css="",validation_req=!1,sidebar_form_valid=[],save_block=$("#tb_"+block_id),css_props={},js_props={},data_json_css=save_block.attr("data-css-props"),data_json_text=save_block.attr("data-text-props"),default_upload_url=$("#thwec-sidebar-element-wrapper").find(".thwec-upload-preview").attr("data-default-url");data_json_css=$.parseJSON(data_json_css),data_json_text=$.parseJSON(data_json_text);var data_css=$.extend({},data_json_css,data_json_text);is_sidebar_validation_required_block(block_name)&&(validation_req=!0);var value=thwec_base.get_form_field_value(field,event.target.type);key in ELM_FORM_PROPS&&(key=ELM_FORM_PROPS[key]);var style_props=key in ELM_BLOCK_FORM_PROPS&&ELM_BLOCK_FORM_PROPS[key];if(style_props){if(key in data_css)if(validation_req&&(sidebar_form_valid=thwec_sb_form_custom_validations(key,value,block_name)),"additional_css"==key&&(additional_css=value,value=""),void 0!==style_props.attribute)if("textarea_content"==key){var cleaned_textarea=thwec_base.escapeHTML(value);data_json_text[key]=cleaned_textarea,data_json_css[key]="",js_props[key]=cleaned_textarea,css_props[key]=""}else if("custom_hook_name"==key)data_json_text[key]=value,js_props[key]=value;else{data_json_text[key]=value,js_props[key]=value;var cleaned_value=clean_css_value(key,value,block_name,block_id,default_upload_url);data_json_css[key]=cleaned_value,css_props[key]=cleaned_value}else value=clean_css_value(key,value,block_name,block_id,default_upload_url),data_json_css[key]=value,css_props[key]=value;if(!$.isEmptyObject(css_props)&&key in CSS_PROPS){var css_prop=CSS_PROPS[key].name,css_value=""!=css_props[key]?css_props[key]:DEFAULT_CSS[css_prop];if(!thwec_base.isCssValid(css_prop,css_value))return}if(0===sidebar_form_valid.length){$("#thwec-sidebar-settings").find("#sb_validation_msg").html("")
;var text_json_props=JSON.stringify(data_json_text);if(data_json_css&&css_props){var css_json_props=JSON.stringify(data_json_css);save_block.attr("data-css-props",css_json_props)}if(data_json_text&&js_props&&save_block.attr("data-text-props",text_json_props),$.each(FONT_LIST,function(key,value){key==css_props.font_family&&(css_props.font_family=value),key==css_props.details_font_family&&(css_props.details_font_family=value)}),perform_block_level_functions(block_id,block_name,css_props,additional_css),prepare_css_functions(key,css_props,block_id,block_name),after_css_rendering(block_id,block_name),"order_details"==block_name){!("ot_head_product_enable"in css_props)||css_props.ot_head_product_enable,!("ot_head_quantity_enable"in css_props)||css_props.ot_head_quantity_enable,!("ot_head_price_enable"in css_props)||css_props.ot_head_price_enable}$.isEmptyObject(js_props)||prepare_text_override(js_props,block_id,block_name),$("#tb_temp_builder").attr("data-css-change","false"),thwec_var.save_temp_on_settings,thwec_var.save_temp_on_settings&&thwec_settings.initiateTemplateSave($("#thwec_template_save"))}else{var message="";$.each(sidebar_form_valid,function(status,msg){message+='<p class="thwec-msg-error">'+msg.message+"</p>"}),$("#thwec-sidebar-settings").find("#sb_validation_msg").html(message)}}}function clean_css_value(key,value,block_name,block_id,default_upload_url){if(key in VISIBLE_OPTIONS&&("header_details"==block_name&&(value=value!==default_upload_url?value:""),value="image"==block_name||"gif"==block_name||"header_details"==block_name?""!==value?VISIBLE_OPTIONS[key][block_name].css:"none":""!==value?VISIBLE_OPTIONS[key].css:"none"),-1!==$.inArray(key,IMG_CSS)&&value&&(value=value!==default_upload_url&&""!==value?"url("+value+")":""),"product_img"==key&&(value=1==value?"block":"none",set_order_table_product_image(value,block_id)),key in HTML_TABLE_PROPS){set_layout_row_html_table_props(block_id,value,1==value,key)}return value}function display_save_messages(){$("#thwec_builder_save_messages").html("Settings Saved").addClass("thwec-show-save thwec-save-success"),$("#save_settings_button").find(".save_form").attr("disabled",!0),setTimeout(function(){$("#thwec_builder_save_messages").removeClass("thwec-show-save thwec-save-success"),$("#save_settings_button").find(".save_form").removeAttr("disabled")},3e3)}function perform_block_level_functions(id,name,css,additional){if(is_address_block(name)){var align_float=css.align;css.align="",$("#tb_"+id).find(".thwec-address-alignment").attr("align",align_float)}else if("order_details"==name){var align_float=css.align,order_block=$("#tb_"+id);order_block.find(".order-padding").attr("align",align_float)}else if("social"==name){var align_content=css.content_align;$("#tb_"+id+" .thwec-social-outer-td").attr("align",align_content)}}function after_css_rendering(blo_id,blo_name){if("image"==blo_name||"social"==blo_name||"header_details"==blo_name||"gif"==blo_name){var img=$("#tb_"+blo_id).find("img"),img_wrap=$("#tb_"+blo_id).find("p"),width=img.width(),height=img.height(),img_w=img_wrap.width(),img_h=img_wrap.height(),json_comp={cmp_img_width:width,cmp_img_height:height,cmp_img_wrap_width:img_w,cmp_img_wrap_height:img_h};img.attr({width:width,height:height}),img_wrap.attr({width:img_w,height:img_h}),$("#tb_"+blo_id).attr("data-css-compat",JSON.stringify(json_comp))}}function thwec_sb_form_custom_validations(f_key,f_value,b_name){var result=!1;return"custom_hook"==b_name&&"custom_hook_name"==f_key&&(result=thwec_settings.custom_tname_validation(f_value,"Hook")),result}function set_layout_row_html_table_props(id,value,cell_flag,cell_attr){var elm=$("#tb_"+id);cell_flag?elm.attr(HTML_TABLE_PROPS[cell_attr],"0"):elm.removeAttr(HTML_TABLE_PROPS[cell_attr])}function set_order_table_product_image(value,block_id){var elm=$("#tb_"+block_id).find(".thwec-order-item-img");"block"==value?$("#tb_"+block_id).find(".thwec-order-item-img").addClass("show-product-img"):"none"==value&&elm.hasClass("show-product-img")&&$("#tb_"+block_id).find(".thwec-order-item-img").removeClass("show-product-img")}function prepare_css_functions(key,props,block_id,block_name){var tb_css_override_elm=$("#thwec_template_css_override"),tb_css_override=tb_css_override_elm.html();tb_css_override+=prepare_css_override(key,props,"tb_"+block_id,block_name,!0),tb_css_override_elm.html(tb_css_override);var prev_css_override_elm=$("#thwec_template_css_preview_override"),prev_css_override=prev_css_override_elm.html();prev_css_override+=prepare_css_override(key,props,"tp_"+block_id,block_name,!0),prev_css_override_elm.html(prev_css_override)}function prepare_css_override(key,props,blockId,blockName,isPrev){var css="";switch(blockName){case"one_column":case"two_column":case"three_column":case"four_column":case"row_clone":css=prepare_css_override_layout_row(key,props,blockId,isPrev);break;case"one_column_one":case"two_column_one":case"two_column_two":case"three_column_one":case"three_column_two":case"three_column_three":case"four_column_one":case"four_column_two":case"four_column_three":case"four_column_four":case"column_clone":css=prepare_css_override_layout_col(key,props,blockId,isPrev);break;case"header_details":css=prepare_css_override_elm_header(key,props,blockId,isPrev);break;case"footer_details":css=prepare_css_override_elm_footer(key,props,blockId,isPrev);break;case"customer_address":css=prepare_css_override_elm_customer(key,props,blockId,isPrev);break;case"billing_address":css=prepare_css_override_elm_billing(key,props,blockId,isPrev);break;case"shipping_address":css=prepare_css_override_elm_shipping(key,props,blockId,isPrev);break;case"text":css=prepare_css_override_elm_text(key,props,blockId,isPrev);break;case"image":css=prepare_css_override_elm_image(key,props,blockId,isPrev);break;case"social":css=prepare_css_override_elm_social(key,props,blockId,isPrev);break;case"button":css=prepare_css_override_elm_button(key,props,blockId,isPrev);break;case"order_details":css=prepare_css_override_elm_order(key,props,blockId,isPrev);break;case"gap":css=prepare_css_override_elm_gap(key,props,blockId,isPrev);break;case"divider":css=prepare_css_override_elm_divider(key,props,blockId,isPrev);break;case"gif":css=prepare_css_override_elm_gif(key,props,blockId,isPrev);break;case"temp_builder":css=prepare_css_override_builder_container(key,props,blockId,isPrev);break;default:css=""}return css}function prepare_text_override(js_props,block_id,block_name){block_id="tb_"+block_id;var text_elm_class=prepare_text_attributes(js_props,block_id,block_name);$.each(text_elm_class,function(name,props){if(""==props.class)var block_ref=$("#"+block_id);else{var block_ref=$("#"+block_id).find(props.class);block_ref=block_ref.length<1?$("#"+block_id):block_ref}if(block_ref)if("image"==props.attribute)block_ref.attr("src",js_props[name]);else if("html"==props.attribute)if("text"==block_name&&""!=js_props[name]){var formated_txt=js_props[name].replace(/\r?\n/g,"<br/>");formated_txt=thwec_base.escapeHTML(formated_txt),block_ref.html(formated_txt)}else block_ref.html(js_props[name]);else"text"==props.attribute?block_ref.text(js_props[name]):"link"==props.attribute?block_ref.attr("href",js_props[name]):"title"==props.attribute&&block_ref.attr("title",js_props[name])})}function prepare_css_override_layout_row(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-row",row_css="",row_props_arr=["height","border_spacing","p_t","p_r","p_b","p_l","m_t","m_r","m_b","m_l","b_t","b_r","b_b","b_l","border_style","border_color","upload_bg_url","bg_color","bg_position","bg_size","bg_repeat"];return-1!==$.inArray(key,row_props_arr)&&(row_css=w_selector+" {",row_css+=prepare_css(props),row_css+="}"),row_css}function prepare_css_override_layout_col(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".column-padding{",col_css="",col_props_arr=["width","text_align","vertical_align","p_t","p_r","p_b","p_l","b_t","b_r","b_b","b_l","border_style","border_color","bg_color","upload_bg_url","bg_size","bg_size","bg_repeat","bg_position"];return-1!==$.inArray(key,col_props_arr)&&(col_css=w_selector,col_css+=prepare_css(props),col_css+="}"),col_css}function prepare_css_override_elm_header(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-header",w_css="",tr_css="",td_css="",img_css="",h1_wp_css="",h1_css="",w_props=["size_width","size_height","bg_color","upload_bg_url","bg_repeat","bg_position","bg_size","m_t","m_r","m_b","m_l","b_t","b_r","b_b","b_l","border_style","border_color"];-1!==$.inArray(key,w_props)&&(w_css=w_selector+"{",w_css+=prepare_css(props),w_css+="}");var tr_props=["upload_img_url"];-1!==$.inArray(key,tr_props)&&(tr_css=w_selector+" .header-logo-tr{",tr_css+=prepare_css(props),tr_css+="}");var td_props=["content_align","img_p_t","img_p_r","img_p_b","img_p_l"];-1!==$.inArray(key,td_props)&&(td_css=w_selector+" .header-logo{",td_css+=prepare_css(props),td_css+="}");var img_props=["img_m_t","img_m_r","img_m_b","img_m_l","img_size_height","img_size_width","img_border_width_top","img_border_width_right","img_border_width_bottom","img_border_width_left","img_border_color","img_border_style","img_bg_color","align"];-1!==$.inArray(key,img_props)&&(img_css=w_selector+" .header-logo .header-logo-ph{",img_css+=prepare_css(props),img_css+="}");var h1_wp_props=["p_t","p_r","p_b","p_l"];-1!==$.inArray(key,h1_wp_props)&&(h1_wp_css=w_selector+" .header-text{",h1_wp_css+=prepare_css(props),h1_wp_css+="}");var h1_props=["font_size","color","font_weight","text_align","line_height","font_family"];return-1!==$.inArray(key,h1_props)&&(h1_css=w_selector+" .header-text h1{",h1_css+=prepare_css(props),h1_css+="}"),w_css+tr_css+td_css+img_css+h1_wp_css+h1_css}function prepare_css_override_elm_text(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-text",table_css="",elm_css="",elm_child_css="",table_props_arr=["color","align","font_size","line_height","font_weight","font_family","size_width","size_height","m_t","m_r","m_b","m_l","text_align"];-1!==$.inArray(key,table_props_arr)&&(table_css=w_selector+"{",table_css+=prepare_css(props),table_css+="}");var elm_props_arr=["color","font_size","font_weight","line_height","text_align","font_family","bg_color","upload_bg_url","bg_size","bg_position","bg_repeat","b_t","b_r","b_b","b_l","border_color","border_style","p_t","p_r","p_b","p_l"];-1!==$.inArray(key,elm_props_arr)&&(elm_css=w_selector+" .thwec-block-text-holder{",elm_css+=prepare_css(props),elm_css+="}");var elm_child_props_arr=["color","font_size","font_weight","line_height","font_family"];if(-1!==$.inArray(key,elm_child_props_arr)){var elm_child_css=w_selector+" *:not(br){";elm_child_css+=prepare_css(props),elm_child_css+="}"}return table_css+elm_css+elm_child_css}function prepare_css_override_elm_image(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-image",tb_css="",td_css="",img_css="",tb_props_arr=["img_m_t","img_m_r","img_m_b","img_m_l","img_bg_color","img_bg_color"];-1!==$.inArray(key,tb_props_arr)&&(tb_css=w_selector+"{",tb_css+=prepare_css(props),tb_css+="}");var td_props_arr=["content_align"];-1!==$.inArray(key,td_props_arr)&&(td_css=w_selector+" td.thwec-image-column{",td_css+=prepare_css(props),td_css+="}");var img_props_arr=["img_size_width","img_size_height","img_p_t","img_p_r","img_p_b","img_p_l","img_border_width_top","img_border_width_right","img_border_width_bottom","img_border_width_left","img_border_style","img_border_color"];return-1!==$.inArray(key,img_props_arr)&&(img_css=w_selector+" td.thwec-image-column p{",img_css+=prepare_css(props),img_css+="}"),tb_css+td_css+img_css}function prepare_css_override_elm_social(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-social",w_css="",inner_tb_css="",table_td_css="",icons_css="",icon1_css="",icon2_css="",icon3_css="",icon4_css="",icon5_css="",icon6_css="",icon7_css="",tb_props_arr=["content_align","m_t","m_r","m_b","m_l","bg_color","upload_bg_url","bg_size","bg_position","bg_repeat","b_t","b_r","b_b","b_l","border_style","border_color"];-1!==$.inArray(key,tb_props_arr)&&(w_css=w_selector+"{",w_css+=prepare_css(props),w_css+="}");var inner_tb_props=["p_t","p_r","p_b","p_l"];-1!==$.inArray(key,inner_tb_props)&&(inner_tb_css=w_selector+" .thwec-social-outer-td{",inner_tb_css+=prepare_css(props),inner_tb_css+="}");var table_td_props=["content_align","icon_p_t","icon_p_r","icon_p_b","icon_p_l"];-1!==$.inArray(key,table_td_props)&&(table_td_css=w_selector+" .thwec-social-td{",table_td_css+=prepare_css(props),table_td_css+="}");var icons_props=["img_size_width","img_size_height"];return-1!==$.inArray(key,icons_props)&&(icons_css=w_selector+" .thwec-social-icon{",icons_css+=prepare_css(props),icons_css+="}"),-1!==$.inArray(key,["url1"])&&(icon1_css=w_selector+" td.thwec-td-fb{",icon1_css+=prepare_css(props),icon1_css+="}"),-1!==$.inArray(key,["url2"])&&(icon2_css=w_selector+" td.thwec-td-mail{",icon2_css+=prepare_css(props),icon2_css+="}"),-1!==$.inArray(key,["url3"])&&(icon3_css=w_selector+" td.thwec-td-tw{",icon3_css+=prepare_css(props),icon3_css+="}"),-1!==$.inArray(key,["url4"])&&(icon4_css=w_selector+" td.thwec-td-yb{",icon4_css+=prepare_css(props),icon4_css+="}"),-1!==$.inArray(key,["url5"])&&(icon5_css=w_selector+" td.thwec-td-lin{",icon5_css+=prepare_css(props),icon5_css+="}"),-1!==$.inArray(key,["url6"])&&(icon6_css=w_selector+" td.thwec-td-pin{",icon6_css+=prepare_css(props),icon6_css+="}"),-1!==$.inArray(key,["url7"])&&(icon7_css=w_selector+" td.thwec-td-insta{",icon7_css+=prepare_css(props),icon7_css+="}"),w_css+inner_tb_css+table_td_css+icons_css+icon1_css+icon2_css+icon3_css+icon4_css+icon5_css+icon6_css+icon7_css}function prepare_css_override_elm_button(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-button-wrapper-table",btn_wrapper_css="",btn_css="",link_css="",btn_wrapper_props=["size_width","size_height","m_t","m_r","m_b","m_l","p_t","p_r","p_b","p_l"];-1!==$.inArray(key,btn_wrapper_props)&&(btn_wrapper_css=w_selector+"{",btn_wrapper_css+=prepare_css(props),btn_wrapper_css+="}");var btn_props=["font_weight","font_size","font_family","color","bg_color","upload_bg_url","bg_repeat","bg_size","bg_position","b_t","b_b","b_l","b_r","border_style","border_color","content_p_t","content_p_r","content_p_b","content_p_l","text_align"];-1!==$.inArray(key,btn_props)&&(btn_css=w_selector+" .thwec-button-wrapper{",btn_css+=prepare_css(props),btn_css+="}");var link_props=["font_weight","line_height","font_size","font_family","color","text_align"];return-1!==$.inArray(key,link_props)&&(link_css=w_selector+" .thwec-button-link{",link_css+=prepare_css(props),link_css+="}"),btn_wrapper_css+btn_css+link_css}function prepare_css_override_elm_customer(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-customer",tb_wrapper_css="",w_css="",h2_css="",details_css="",tb_wrapper_props=["size_width","size_height","bg_color","upload_bg_url","bg_size","bg_position","bg_repeat","b_t","b_r","b_b","b_l","border_style","border_color","m_t","m_r","m_b","m_l"];-1!==$.inArray(key,tb_wrapper_props)&&(tb_wrapper_css=w_selector+" .thwec-address-wrapper-table{",tb_wrapper_css+=prepare_css(props),tb_wrapper_css+="}");var w_props=["p_t","p_r","p_b","p_l"];-1!==$.inArray(key,w_props)&&(w_css=w_selector+" .customer-padding{",w_css+=prepare_css(props),w_css+="}");var h2_props=["font_size","color","text_align","font_weight","line_height","font_family"];-1!==$.inArray(key,h2_props)&&(h2_css=w_selector+" .thwec-customer-header{",h2_css+=prepare_css(props),h2_css+="}");var details_props=["details_font_size","details_color","details_text_align","details_font_family","details_font_weight","details_line_height"];return-1!==$.inArray(key,details_props)&&(details_css=w_selector+" .thwec-customer-body{",details_css+=prepare_css(props),details_css+="}"),tb_wrapper_css+w_css+h2_css+details_css}function prepare_css_override_elm_billing(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-billing",tb_wrapper_css="",w_css="",h2_css="",details_css="",tb_wrapper_props=["size_width","size_height","bg_color","upload_bg_url","bg_size","bg_position","bg_repeat","b_t","b_r","b_b","b_l","border_style","border_color","m_t","m_r","m_b","m_l"];-1!==$.inArray(key,tb_wrapper_props)&&(tb_wrapper_css=w_selector+" .thwec-address-wrapper-table{",tb_wrapper_css+=prepare_css(props),tb_wrapper_css+="}");var w_props=["p_t","p_r","p_b","p_l"];-1!==$.inArray(key,w_props)&&(w_css=w_selector+" .billing-padding{",w_css+=prepare_css(props),w_css+="}");var h2_props=["font_size","color","text_align","font_weight","font_family","line_height"];-1!==$.inArray(key,h2_props)&&(h2_css=w_selector+" .thwec-billing-header{",h2_css+=prepare_css(props),h2_css+="}");var details_props=["details_font_size","details_color","details_text_align","details_font_family","details_font_weight","details_line_height"];return-1!==$.inArray(key,details_props)&&(details_css=w_selector+" .thwec-billing-body{",details_css+=prepare_css(props),details_css+="}"),tb_wrapper_css+w_css+h2_css+details_css}function prepare_css_override_elm_shipping(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-shipping",tb_wrapper_css="",w_css="",h2_css="",details_css="",tb_wrapper_props=["size_width","size_height","bg_color","upload_bg_url","bg_size","bg_position","bg_repeat","b_t","b_r","b_b","b_l","border_style","border_color","m_t","m_r","m_b","m_l"];-1!==$.inArray(key,tb_wrapper_props)&&(tb_wrapper_css=w_selector+" .thwec-address-wrapper-table{",tb_wrapper_css+=prepare_css(props),tb_wrapper_css+="}");var w_props=["p_t","p_r","p_b","p_l"];-1!==$.inArray(key,w_props)&&(w_css=w_selector+" .shipping-padding{",w_css+=prepare_css(props),w_css+="}");var h2_props=["font_size","color","text_align","font_weight","line_height","font_family"];-1!==$.inArray(key,h2_props)&&(h2_css=w_selector+" .thwec-shipping-header{",h2_css+=prepare_css(props),h2_css+="}");var details_props=["details_font_size","details_color","details_text_align","details_font_family","details_font_weight","details_line_height"];return-1!==$.inArray(key,details_props)&&(details_css=w_selector+" .thwec-shipping-body{",details_css+=prepare_css(props),details_css+="}"),tb_wrapper_css+w_css+h2_css+details_css}function prepare_css_override_elm_order(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-order",elm_css="",w_css="",h2_css="",table_css="",tb_content_css="",tb_image_css="",elm_props=["align","size_width","size_height","bg_color","m_t","m_r","m_b","m_l","upload_bg_url","bg_size","bg_repeat","bg_repeat","b_t","b_r","b_b","b_l","border_style","border_color"];-1!==$.inArray(key,elm_props)&&(elm_css=w_selector+"{",elm_css+=prepare_css(props),elm_css+="}");var w_props=["p_t","p_r","p_b","p_l"];-1!==$.inArray(key,w_props)&&(w_css=w_selector+" .order-padding{",w_css+=prepare_css(props),w_css+="}");var h2_props=["color","font_size","text_align","font_weight","line_height","font_family"];-1!==$.inArray(key,h2_props)&&(h2_css=w_selector+" .thwec-order-heading{",h2_css+=prepare_css(props),h2_css+="}");var table_props=["content_size_width","content_size_height","content_bg_color","content_border_color","content_m_t","content_m_r","content_m_b","content_m_l","details_font_family"];-1!==$.inArray(key,table_props)&&(table_css=w_selector+" .thwec-order-table{",table_css+=prepare_css(props),table_css+="}");var tb_content_props=["details_font_size","details_color","details_text_align","details_font_family","content_border_color","details_font_weight","details_line_height","content_p_t","content_p_r","content_p_b","content_p_l"];-1!==$.inArray(key,tb_content_props)&&(tb_content_css=w_selector+" .thwec-td{",tb_content_css+=prepare_css(props),tb_content_css+="}",prepare_ot_column_styles(blockId,key,props));var tb_image_props=["product_img"];return-1!==$.inArray(key,tb_image_props)&&(tb_image_css=w_selector+" .thwec-td .thwec-order-item-img{",tb_image_css+=prepare_css(props),tb_image_css+="}"),elm_css+w_css+h2_css+table_css+tb_content_css+tb_image_css}function prepare_ot_column_styles(blockId,key,props){var block=1===$("#"+blockId).length&&$("#"+blockId),ot_td_css=!1;if(block){var ot_td_elm=block.find(".order-total-loop-end"),ot_td_css=ot_td_elm.attr("data-ot-css");ot_td_css&&(ot_td_css=$.parseJSON(ot_td_css),ot_td_css[key]&&(ot_td_css[key]=props[key]),ot_td_css=JSON.stringify(ot_td_css)),ot_td_elm.attr("data-ot-css",ot_td_css)}}function prepare_css_override_elm_gap(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-gap",w_css="",w_props=["height","bg_color","upload_bg_url","bg_repeat","bg_size","bg_position","b_t","b_b","b_l","b_r","border_style","border_color"];return-1!==$.inArray(key,w_props)&&(w_css=w_selector+"{",w_css+=prepare_css(props),w_css+="}"),w_css}function prepare_css_override_elm_divider(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-divider",tb_css="",td_css="",hr_css="",tb_props=["m_t","m_r","m_b","m_l"];-1!==$.inArray(key,tb_props)&&(tb_css=w_selector+"{",tb_css+=prepare_css(props),tb_css+="}");var td_props=["p_t","p_r","p_b","p_l","content_align"];-1!==$.inArray(key,td_props)&&(td_css=w_selector+" td{",td_css+=prepare_css(props),td_css+="}");var hr_props=["width","divider_height","divider_color","divider_style"];return-1!==$.inArray(key,hr_props)&&(hr_css=w_selector+" td hr{",hr_css+=prepare_css(props),hr_css+="}"),tb_css+td_css+hr_css}function prepare_css_override_elm_gif(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".thwec-block-gif",tb_css="",td_css="",gif_css="",tb_props=["upload_bg_url","bg_position","bg_size","bg_repeat","bg_color","m_t","m_r","m_b","m_l"];-1!==$.inArray(key,tb_props)&&(tb_css=w_selector+"{",tb_css+=prepare_css(props),tb_css+="}");var td_props=["content_align"];-1!==$.inArray(key,td_props)&&(td_css=w_selector+" td.thwec-gif-column{",td_css+=prepare_css(props),td_css+="}");var gif_props=["img_size_width","img_size_height","p_t","p_r","p_b","p_l","b_t","b_r","b_b","b_l","border_color","border_style"];return-1!==$.inArray(key,gif_props)&&(gif_css=w_selector+" td.thwec-gif-column p{",gif_css+=prepare_css(props),gif_css+="}"),tb_css+td_css+gif_css}function prepare_css_override_builder_container(key,props,blockId,isPrev){var p_selector=get_css_parent_selector(blockId,isPrev),w_selector=p_selector+".main-builder .thwec-builder-column",tb_css="",tb_props=["b_t","b_r","b_b","b_l","border_style","border_color","bg_size","bg_repeat","bg_color","upload_bg_url","bg_position"];if(-1!==$.inArray(key,tb_props)){var tb_css=w_selector+"{";tb_css+=prepare_css(props),tb_css+="}"}return tb_css}function prepare_text_attributes(js_props,block_id,block_name){var text_css={};switch(block_name){case"header_details":text_css={content:{class:".header-text h1",attribute:"html"},upload_img_url:{class:".header-logo-ph img",attribute:"image"}};break;case"footer_details":text_css={textarea_content:{class:".footer-text",attribute:"html"}};break;case"customer_address":text_css={content:{class:".thwec-customer-header",attribute:"html"}};break;case"order_details":text_css={content:{class:".thwec-order-heading .order-title",attribute:"html"}};break;case"billing_address":text_css={content:{class:".thwec-billing-header",attribute:"html"}};break;case"shipping_address":text_css={content:{class:".thwec-shipping-header",attribute:"html"}};break;case"text":text_css={textarea_content:{class:".thwec-block-text-holder",attribute:"html"}};break;case"image":text_css={upload_img_url:{class:"img",attribute:"image"}};break;case"social":text_css={url1:{class:".facebook",attribute:"link"},url2:{class:".mail",attribute:"link"},url3:{class:".twitter",attribute:"link"},url4:{class:".youtube",attribute:"link"},url5:{class:".linkedin",attribute:"link"},url6:{class:".pinterest",attribute:"link"},url7:{class:".instagram",attribute:"link"}};break;case"button":text_css={content:{class:".thwec-button-link",attribute:"html"},url:{class:".thwec-button-link",attribute:"link"},title:{class:".thwec-button-link",attribute:"title"}};break;case"menu":text_css={block_text_url1:{class:".menu-item1 .menu-link",attribute:"link"},block_text_url2:{class:".menu-item2 .menu-link",attribute:"link"},block_text_url3:{class:".menu-item3 .menu-link",attribute:"link"},block_text_url4:{class:".menu-item4 .menu-link",attribute:"link"},block_text_url5:{class:".menu-item5 .menu-link",attribute:"link"},block_text1:{class:".menu-item1 .menu-link",attribute:"html"},block_text2:{class:".menu-item2 .menu-link",attribute:"html"},block_text3:{class:".menu-item3 .menu-link",attribute:"html"},block_text4:{class:".menu-item4 .menu-link",attribute:"html"},block_text5:{class:".menu-item5 .menu-link",attribute:"html"}};break;case"gif":text_css={upload_img_url:{class:"img",attribute:"image"}};break;case"custom_hook":text_css={custom_hook_name:{class:".hook-text",attribute:"text"}};break;default:text_css=""}return text_css}function change_sidebar_status($configure){if($configure){var active="thwec-sidebar-configure",inactive="thwec-sidebar-settings";$("#thwec_header_sidebar_nav").addClass("thwec-inactive-nav")}else{var active="thwec-sidebar-settings",inactive="thwec-sidebar-configure";$("#thwec_header_sidebar_nav").removeClass("thwec-inactive-nav")}var settings_panel=$("#thwec-sidebar-element-wrapper");if(settings_panel.find("#"+active).removeClass("inactive-tab").addClass("active-tab"),settings_panel.find("#"+inactive).removeClass("active-tab").addClass("inactive-tab"),1==$("#thwec-sidebar-settings").find(".thwec-block-settings-form").length&&$configure){var block_id=$("#thwec-sidebar-settings").find('input[name="i_block_id"]').val(),builder_elm=$("#tb_"+block_id),panel_elm=$("#"+block_id);(builder_elm.hasClass("thwec-block")||builder_elm.hasClass("hook-code"))&&focus_selected_element(builder_elm,panel_elm,"builder")}}function setup_sidebar_builder_clicks(){$("#thwec-sidebar-settings").on("click",".elm-col",function(event){var form=$("#thwec-sidebar-settings").find("form");remove_builder_panel_highlights(),change_sidebar_status("thwec-sidebar-configure","thwec-sidebar-configure");var block_identifier=thwec_base.get_property_field_value(form,"hidden","block_id"),col_count=thwec_base.get_property_field_value(form,"hidden","col_count");block_identifier=block_identifier||"",add_builder_elements($(this).find("div").data("block-name"),block_identifier,col_count),setup_template_builder(),activate_panel_wrapper_scroll(!1)}),$(".thwec-builder-elm-layers").on("click",".btn-add-column",function(event){event.preventDefault(),remove_builder_panel_highlights();var popup=$("#thwec_confirmation_alerts"),form=$("#thwec_confirmation_alert_form");popup.find(".thwec-messages").html($("#thwec_column_confirm").html());var selected_id=$(this).closest("div.btn-add-column").data("parent");confirm_flag?(thwec_base.set_property_field_value(form,"hidden","thwec_column_reference",selected_id,0),thwec_base.set_property_field_value(form,"hidden","thwec_flag_reference","add_column",0),popup.dialog("open")):add_column_confirmation(selected_id,"add_column")}),$(".thwec-tbuilder-wrapper").on("click",".btn-add-element",function(event){event.preventDefault(),remove_builder_panel_highlights(),setup_sidebar_general("layout-elements");var form=$("#thwec-sidebar-settings").find("form");if($(this).hasClass("panel-add-btn"))var click_elm=$(this).closest("div.columns").attr("id"),column_count=$(this).closest(".rows.panel-builder-block").attr("data-columns");else if($(this).hasClass("builder-add-btn"))var click_elm=$(this).closest("td").attr("id").replace("tb_",""),column_count=$(this).closest(".thwec-row.builder-block").attr("data-column-count");thwec_base.set_property_field_value(form,"hidden","block_id",click_elm,0),thwec_base.set_property_field_value(form,"hidden","col_count",column_count,0),change_sidebar_status(!1),$("#thwec-sidebar-settings").find(".thwec-tbuilder-elm-grid-layout-element .column-basic-elements .grid-category").removeClass("category-collapse"),activate_panel_layout_wrapper_scroll(!1,!1,!1,!0)}),$(".thwec-tbuilder-wrapper").on("click",".element-name,.hook-name",function(event){var clicked=$(this),panel_elm=clicked.closest(".panel-builder-block"),panel_elm_id=panel_elm.attr("id");focus_selected_element($("#tb_"+panel_elm_id),panel_elm,"builder")}),$("#tb_temp_builder").on("click",".thwec-block",function(event){remove_builder_panel_highlights();var builder_elm=$(this),builder_elm_id=builder_elm.attr("id"),panel_elm_id=builder_elm_id.replace("tb_","");$(".thwec-builder-elm-layers").find("#"+panel_elm_id);open_builder_block_edit_sidebar(builder_elm,panel_elm_id,builder_elm.attr("data-block-name"))}),$(".thwec-tbuilder-wrapper").on("click",".thwec-aligment-icon-wrapper .img-wrapper",function(event){var icon_elm=$(this),icon_wrapper=$(this).closest(".thwec-aligment-icon-wrapper"),align_val=($("#thwec-sidebar-settings").find("form"),icon_elm.attr("data-align"));icon_wrapper.find(".thwec-text-align-input").val(align_val),icon_wrapper.find(".thwec-text-align-input").trigger("keyup"),icon_wrapper.find(".thwec-active-icon").removeClass("thwec-active-icon"),icon_wrapper.find(".thwec-active-icon").removeClass("thwec-active-icon"),icon_elm.addClass("thwec-active-icon")})}function setup_confirmation_alerts(){$("#thwec_confirmation_alerts").dialog({position:{my:"center",at:"center",of:$("#thwec-sidebar-element-wrapper")},draggable:!0,appendTo:"#thwec-sidebar-element-wrapper",modal:!0,width:275,resizable:!1,autoOpen:!1,dialogClass:"thwec-confirmations",buttons:[{text:"Cancel",click:function(){$(this).dialog("close")}},{text:"Ok",click:function(){var form=$(this).find("#thwec_confirmation_alert_form");add_column_confirmation(!1,thwec_base.get_property_field_value(form,"hidden","thwec_flag_reference")),$(this).dialog("close")}}]})}function add_column_confirmation(row_id,flag_option){var form=$("#thwec_confirmation_alert_form"),flag_option=thwec_base.get_property_field_value(form,"hidden","thwec_flag_reference");if("add_column"==flag_option){if(!row_id)var row_id=thwec_base.get_property_field_value(form,"hidden","thwec_column_reference");confirm_flag=!1;var column_id=get_random_string(),column_html=get_column_html(column_id);$("#tb_temp_builder").find("#tb_"+row_id+" > tbody > tr:first").append(column_html);var column_track_html=add_new_track_col(row_id,column_id,"column_clone",null);$(column_track_html).insertBefore($("div.thwec-builder-elm-layers").find("#"+row_id+" > .column-set > div.btn-add-column"));var old_column_number=$("#"+row_id).attr("data-columns"),new_column_number=parseInt(old_column_number)+1;$("#"+row_id).attr("data-columns",new_column_number),$("#tb_"+row_id).attr("data-column-count",new_column_number),reset_col_width(row_id,new_column_number)}else if("clone_column"==flag_option){var column_id=thwec_base.get_property_field_value(form,"hidden","thwec_column_id");confirm_clone_column_flag=!1,builder_block_clone(column_id,!0)}}function confirm_builder_block_clone(elm){if($(elm).closest(".panel-builder-block").hasClass("columns")){var popup=$("#thwec_confirmation_alerts"),form=$("#thwec_confirmation_alert_form");popup.find(".thwec-messages").html($("#thwec_column_confirm").html());var selected_id=$(elm).closest(".panel-builder-block").attr("id");confirm_clone_column_flag?(thwec_base.set_property_field_value(form,"hidden","thwec_column_reference","",0),
thwec_base.set_property_field_value(form,"hidden","thwec_flag_reference","clone_column",0),thwec_base.set_property_field_value(form,"hidden","thwec_column_id",selected_id,0),popup.dialog("open")):builder_block_clone(selected_id,!0)}else builder_block_clone(elm,!1)}function builder_block_clone(elm_ref,$check_flag){var elm=$check_flag?$("#"+elm_ref+" >.layout-lis-item .template-action-clone"):elm_ref,clone_status="",settings_block=$(elm).closest(".thwec-block-settings"),selected_panel_block=settings_block.closest(".panel-builder-block"),selected_panel_block_id=selected_panel_block.attr("id"),selected_builder_block=$("#tb_temp_builder").find("#tb_"+selected_panel_block_id),selected_panel_block_class=selected_panel_block.attr("class").split(" "),panel_clone=selected_panel_block.clone([!0][!0]),builder_clone=selected_builder_block.clone([!0][!0]);panel_clone.removeClass("thwec-panel-highlight"),builder_clone.removeClass("thwec-builder-highlight");var id=panel_clone.attr("id"),parent_id=panel_clone.attr("data-parent"),new_id=get_random_string();panel_clone.attr("data-props"),panel_clone.attr("data-social");if(panel_clone.attr("id",new_id),panel_clone.find("> .layout-lis-item > .thwec-block-settings").html(function(i,oldHTML){return oldHTML.replace(id,new_id)}),panel_clone.hasClass("rows")&&panel_clone.find("> .column-set > div").each(function(index,el){$(this).attr("data-parent")&&$(this).attr("data-parent",new_id)}),builder_clone.attr("id","tb_"+new_id),setup_clone_css(builder_clone,new_id),panel_clone.find("[id]")&&panel_clone.find("[id]").each(function(index,el){var find=$(this).attr("id");"rows"==$(this).attr("class")&&$(this).find("> .column-set > div").each(function(index,el){$(this).attr("data-parent")&&$(this).attr("data-parent",id)});var replace=get_random_string();$(this).attr("id",replace),$(this).find("> .layout-lis-item > .thwec-block-settings").html(function(i,oldHTML){return oldHTML.replace(find,replace)}),setup_clone_css(builder_clone.find("#tb_"+find),replace),builder_clone.find("#tb_"+find).attr("id","tb_"+replace)}),"rows"==selected_panel_block_class[0]?clone_status=!0:"columns"==selected_panel_block_class[0]?clone_status=!0:"elements"==selected_panel_block_class[0]&&(clone_status=!0),clone_status&&($(builder_clone).insertAfter(selected_builder_block),$(panel_clone).insertAfter(selected_panel_block),"columns"==selected_panel_block_class[0])){var cols=$("#"+parent_id).attr("data-columns"),col_count=parseInt(cols)+1,remove_class=cols in NUMBER_TO_WORDS?"thwec-block-"+NUMBER_TO_WORDS[cols]+"-column":"thwec-block-n-column",add_class=col_count in NUMBER_TO_WORDS?"thwec-block-"+NUMBER_TO_WORDS[col_count]+"-column":"thwec-block-n-column";$("#"+parent_id).attr("data-columns",col_count),$("#tb_"+parent_id).attr("data-column-count",col_count),$("#tb_"+parent_id).removeClass(remove_class).addClass(add_class),reset_col_width(parent_id,col_count)}}function setup_clone_css(builder_obj,replace){if(builder_obj.attr("data-css-props")){var builder_css=builder_obj.attr("data-css-props");if(builder_css=JSON.parse(builder_css),$.each(FONT_LIST,function(key,value){key==builder_css.font_family?builder_css.font_family=value:key==builder_css.details_font_family&&(builder_css.details_font_family=value)}),builder_obj.attr("data-text-props")){builder_obj.attr("data-text-props")}if(builder_obj.attr("data-block-name"))var obj_type=builder_obj.data("block-name");else if(builder_obj.hasClass("thwec-row"))var obj_type="row_clone";else if(builder_obj.hasClass("thwec-col"))var obj_type="column_clone";$.isEmptyObject(builder_css)||$.each(builder_css,function(index,val){var props={};props[index]=val,prepare_css_functions(index,props,replace,obj_type)})}}function remove_uploaded_image(elm){var upload_pointer=$(elm),default_url=upload_pointer.siblings(".thwec-upload-preview").attr("data-default-url");upload_pointer.siblings(".thwec-upload-url").val(default_url),upload_pointer.siblings(".thwec-upload-url").trigger("keyup"),upload_pointer.closest(".upload-action-settings").find(".thwec-upload-preview img").attr("src",default_url),upload_pointer.closest(".upload-action-settings").find(".thwec-upload-preview img").attr("src",default_url);var notice_tag=upload_pointer.closest(".upload-action-settings").siblings(".thwec-upload-notices");notice_tag.find("p").length>0&&notice_tag.find("p").remove(),upload_pointer.addClass("remove-upload-inactive")}function setup_image_uploader(elm,prop){var frame,file_valid,validation_msg;frame=wp.media({title:"Upload Media Of Your Interest",button:{text:"Choose this"},multiple:!1}),frame.open(),frame.on("select",function(){var thwec_attachment=frame.state().get("selection").first().toJSON();"gif"==prop?(file_valid="image/gif"==thwec_attachment.mime,validation_msg="<p>Invalid file type. Choose a Gif file</p>"):(file_valid="image"==thwec_attachment.type&&-1!==$.inArray(thwec_attachment.mime,FILE_TYPES),validation_msg="<p>Invalid file type. Choose an image file <br>[ jpg, jpeg, png ]</p>");var thwec_attachment_url=thwec_attachment.url,form_table=(thwec_attachment.name,$("#thwec-sidebar-settings").find("form")),upload_block=form_table.find(".upload-action-settings.img-preview-"+prop);file_valid?("bg_image"==prop?(thwec_base.set_property_field_value(form_table,"text","upload_bg_url",thwec_attachment_url,0),form_table.find('input[name="i_upload_bg_url"]').trigger("keyup")):"image"!=prop&&"gif"!=prop||(thwec_base.set_property_field_value(form_table,"text","upload_img_url",thwec_attachment_url,0),form_table.find('input[name="i_upload_img_url"]').trigger("keyup")),upload_block.find(".thwec-upload-preview img").attr("src",thwec_attachment_url),upload_block.find(".remove-upload-btn").hasClass("remove-upload-inactive")&&upload_block.find(".remove-upload-btn").removeClass("remove-upload-inactive"),upload_block.closest("td").find(".thwec-upload-notices").html("")):upload_block.closest("td").find(".thwec-upload-notices").html(validation_msg)})}function setup_template_builder(){sortable_tracking_elements("div.thwec-builder-elm-layers",".sortable-row-handle",".rows",".element-set,.thwec-builder-elm-layers",sortable_start_handler,sortable_out_handler,sortable_stop_handler,null,sortable_receive_handler,sortable_update_handler),sortable_tracking_elements("div.column-set",".sortable-col-handle","> div.columns","",sortable_start_handler,sortable_out_handler,sortable_stop_handler,null,null,sortable_update_handler),sortable_tracking_elements("div.element-set",".sortable-elm-handle","div.hooks,div.elements:not(.panel-add-btn)",".element-set,div.thwec-builder-elm-layers",sortable_start_handler,sortable_out_handler,sortable_stop_handler,null,null,sortable_update_handler)}function sortable_tracking_elements(elm,handle,items,connectWith,start_handler,out_handler,stop_handler,over_handler,receive_handler,update_handler){$(elm).sortable({handle:handle,axis:"x,y",items:items,scroll:!0,cursor:"move",helper:"clone",placeholder:"sortable-row-placeholder",connectWith:connectWith,forcePlaceholderSize:!0,start:start_handler,out:out_handler,over:over_handler,stop:stop_handler,receive:receive_handler,update:update_handler}),$(elm).disableSelection()}function sortable_start_handler(event,ui){DRAGG_CLASS=ui.item.attr("class"),DRAGG_CLASS=$.trim(DRAGG_CLASS.replace("panel-builder-block","")),$(ui.helper).addClass("dragg"),"rows"==DRAGG_CLASS?(ui.helper.find(".column-set").css("display","none"),ui.helper.css("height","unset")):"columns"==DRAGG_CLASS?(ui.helper.find(".element-set").css("display","none"),ui.helper.css("height","unset"),ui.placeholder.addClass("ui-sortable-placeholder-columns")):"elements"!=DRAGG_CLASS&&"hooks"!=DRAGG_CLASS||ui.placeholder.addClass("ui-sortable-placeholder-element-hooks")}function sortable_out_handler(event,ui){if(("rows"==DRAGG_CLASS||"elements"==DRAGG_CLASS)&&ui.item.closest(".columns").length>0){var prev_parent_id=ui.item.closest(".columns").attr("id");ui.item.data("prev-parent",prev_parent_id)}}function sortable_stop_handler(event,ui){$(ui.helper).removeClass("dragg"),$(this).hasClass("elements")&&ui.item.hasClass("elements")}function sortable_receive_handler(event,ui){!$(this).hasClass("thwec-builder-elm-layers")||"elements"!=DRAGG_CLASS&&"hooks"!=DRAGG_CLASS||(ui.placeholder.hide(),ui.sender.sortable("cancel"),alert("Cannot place an element outside a column"))}function sortable_update_handler(event,ui){var track_id="tb_"+ui.item.attr("id"),next_id=ui.item.next().attr("id"),prev_id=ui.item.prev().attr("id");if(prev_id?(prev_id="tb_"+prev_id,$($("#tb_temp_builder").find("#"+track_id)).insertAfter($("#"+prev_id))):(next_id="tb_"+next_id,$($("#tb_temp_builder").find("#"+track_id)).insertBefore($("#"+next_id))),ui.item.closest(".element-set").closest(".columns").length>0){var prev_parent=ui.item.data("prev-parent"),track_id=(ui.item.closest(".element-set").closest(".columns").attr("id"),ui.item.attr("id")),next_id=ui.item.next().attr("id"),prev_id=ui.item.prev().attr("id");if(ui.item.closest(".columns").attr("id"))var column_id=ui.item.closest(".columns").attr("id");var data=$("#tb_temp_builder").find("#tb_"+track_id);prev_id?$(data).insertAfter($("#tb_"+prev_id)):next_id?$(data).insertBefore($("#tb_"+next_id)):next_id||prev_id||$("#tb_temp_builder").find("#tb_"+column_id).html(data);var elem=$("#tb_"+prev_parent);elem.find(".builder-block").length<1&&elem.find(".hook-code").length<1&&$("#tb_"+prev_parent).html(BLANK_TD_DATA)}}function get_style_property_name(key){return key in CSS_PROPS&&CSS_PROPS[key].name}var preview_wrapper,DRAGG_CLASS,WECM_CM=!1,LAYOUT_BLOCKS=(new Array("configure","layouts","layout-element","settings"),new Array("one_column","two_column","three_column","four_column","left-large-column","right-large-column","gallery-column")),LAYOUT_COLUMNS=new Array("one_column_one","two_column_one","two_column_two","three_column_one","three_column_two","three_column_three","four_column_one","four_column_two","four_column_three","four_column_four","column_clone"),HOOK_FEATURES=new Array("email_header","email_order_details","before_order_table","after_order_table","order_meta","customer_details","email_footer","downloadable_product"),ADDRESS_BLOCKS=new Array("billing_address","shipping_address","customer_address"),IMG_CSS=new Array("upload_bg_url","background"),SB_VALIDATION_REQ_BLOCKS=new Array("custom_hook"),COLUMN_NUMBER={one_column:1,two_column:2,three_column:3,four_column:4},NUMBER_TO_WORDS={1:"one",2:"two",3:"three",4:"four"},FILE_TYPES=new Array("image/jpeg","image/png","image/jpg"),TB_DEFAULT='{"b_t":"0px","b_r":"0px","b_b":"0px","b_l":"0px","border_style":"none","border_color":"","bg_color":"#f6f6f6","upload_bg_url":"","bg_position":"","bg_size":"","bg_repeat":"repeat"}',LAYOUT_OBJ={},confirm_flag=!0,confirm_clone_column_flag=!0,BLANK_TD_DATA='<span class="builder-add-btn btn-add-element">+ Add Element</span>',BASIC_PROPS={width:"50%",p_t:"10px",p_r:"10px",p_b:"10px",p_l:"10px",b_t:"1px",b_r:"1px",b_b:"1px",b_l:"1px",border_style:"dotted",border_color:"#dddddd",upload_bg_url:"",bg_color:"none",bg_position:"",bg_size:"",bg_repeat:"repeat",text_align:"center"},FONT_LIST={helvetica:"'Helvetica Neue',Helvetica,Roboto,Arial,sans-serif",georgia:"Georgia, serif",times:"'Times New Roman', Times, serif",arial:"Arial, Helvetica, sans-serif","arial-black":"'Arial Black', Gadget, sans-serif","comic-sans":"'Comic Sans MS', cursive, sans-serif",impact:"Impact, Charcoal, sans-serif",tahoma:"Tahoma, Geneva, sans-serif",trebuchet:"'Trebuchet MS', Helvetica, sans-serif",verdana:"Verdana, Geneva, sans-serif"},HTML_TABLE_PROPS={row_cellpadding:"cellpadding",row_cellspacing:"cellspacing"},CSS_PROPS={p_t:{name:"padding-top"},p_r:{name:"padding-right"},p_b:{name:"padding-bottom"},p_l:{name:"padding-left"},m_t:{name:"margin-top"},m_r:{name:"margin-right"},m_b:{name:"margin-bottom"},m_l:{name:"margin-left"},vertical_align:{name:"vertical-align"},width:{name:"width"},height:{name:"height"},size_width:{name:"width"},size_height:{name:"height"},content_size_width:{name:"width"},content_size_height:{name:"height"},b_t:{name:"border-top-width"},b_r:{name:"border-right-width"},b_b:{name:"border-bottom-width"},b_l:{name:"border-left-width"},border_style:{name:"border-style"},border_color:{name:"border-color"},border_radius:{name:"border-radius"},upload_bg_url:{name:"background-image"},upload_img_url:{name:"display"},bg_color:{name:"background-color"},bg_position:{name:"background-position"},bg_size:{name:"background-size"},bg_repeat:{name:"background-repeat"},color:{name:"color"},font_size:{name:"font-size"},font_weight:{name:"font-weight"},text_align:{name:"text-align"},content_align:{name:"text-align"},line_height:{name:"line-height"},font_family:{name:"font-family"},align:{name:"text-align"},img_width:{name:"width"},img_height:{name:"height"},img_size_width:{name:"width"},img_size_height:{name:"height"},icon_p_t:{name:"padding-top"},icon_p_r:{name:"padding-right"},icon_p_b:{name:"padding-bottom"},icon_p_l:{name:"padding-left"},img_bg_color:{name:"background-color"},img_p_t:{name:"padding-top"},img_p_r:{name:"padding-right"},img_p_b:{name:"padding-bottom"},img_p_l:{name:"padding-left"},img_m_t:{name:"margin-top"},img_m_r:{name:"margin-right"},img_m_b:{name:"margin-bottom"},img_m_l:{name:"margin-left"},img_border_width_top:{name:"border-top-width"},img_border_width_right:{name:"border-right-width"},img_border_width_bottom:{name:"border-bottom-width"},img_border_width_left:{name:"border-left-width"},img_border_style:{name:"border-style"},img_border_color:{name:"border-color"},img_border_radius:{name:"border-radius"},details_color:{name:"color"},details_font_size:{name:"font-size"},details_font_weight:{name:"font-weight"},details_text_align:{name:"text-align"},details_line_height:{name:"line-height"},details_font_family:{name:"font-family"},content_border_width_top:{name:"border-top-width"},content_border_width_right:{name:"border-right-width"},content_border_width_bottom:{name:"border-bottom-width"},content_border_width_left:{name:"border-left-width"},content_border_style:{name:"border-style"},content_border_color:{name:"border-color"},content_border_radius:{name:"border-radius"},content_width:{name:"width"},content_height:{name:"height"},content_bg_color:{name:"background-color"},content_p_t:{name:"padding-top"},content_p_r:{name:"padding-right"},content_p_b:{name:"padding-bottom"},content_p_l:{name:"padding-left"},content_m_t:{name:"margin-top"},content_m_r:{name:"margin-right"},content_m_b:{name:"margin-bottom"},content_m_l:{name:"margin-left"},border_spacing:{name:"border-spacing"},divider_height:{name:"border-top-width"},divider_color:{name:"border-top-color"},divider_style:{name:"border-top-style"},product_img:{name:"display"},url1:{name:"display"},url2:{name:"display"},url3:{name:"display"},url4:{name:"display"},url5:{name:"display"},url6:{name:"display"},url7:{name:"display"},url:{name:"display"}},ELM_BLOCK_FORM_PROPS={p_t:{name:"padding_top",type:"text"},p_r:{name:"padding_right",type:"text"},p_b:{name:"padding_bottom",type:"text"},p_l:{name:"padding_left",type:"text"},m_t:{name:"margin_top",type:"text"},m_r:{name:"margin_right",type:"text"},m_b:{name:"margin_bottom",type:"text"},m_l:{name:"margin_left",type:"text"},vertical_align:{name:"vertical_align",type:"select"},width:{name:"width",type:"text"},height:{name:"height",type:"text"},size_width:{name:"size_width",type:"text"},size_height:{name:"size_height",type:"text"},content_size_width:{name:"content_size_width",type:"text"},content_size_height:{name:"content_size_height",type:"text"},img_size_width:{name:"img_size_width",type:"text"},img_size_height:{name:"img_size_height",type:"text"},b_t:{name:"border_width_top",type:"text"},b_r:{name:"border_width_right",type:"text"},b_b:{name:"border_width_bottom",type:"text"},b_l:{name:"border_width_left",type:"text"},border_style:{name:"border_style",type:"select"},border_color:{name:"border_color",type:"text"},border_radius:{name:"border_radius",type:"text"},bg_color:{name:"bg_color",type:"text"},upload_bg_url:{name:"upload_bg_url",type:"text"},upload_img_url:{name:"upload_img_url",type:"text",attribute:"yes"},bg_position:{name:"bg_position",type:"text"},bg_size:{name:"bg_size",type:"text"},bg_repeat:{name:"bg_repeat",type:"select"},content:{name:"content",type:"text",attribute:"yes"},color:{name:"color",type:"text"},font_size:{name:"font_size",type:"text"},font_weight:{name:"font_weight",type:"text"},text_align:{name:"text_align",type:"hidden"},content_align:{name:"content_align",type:"hidden"},line_height:{name:"line_height",type:"text"},font_family:{name:"font_family",type:"select"},url:{name:"url",type:"text",attribute:"yes"},title:{name:"title",type:"text",attribute:"yes"},align:{name:"align",type:"hidden"},img_width:{name:"img_width",type:"text"},content_width:{name:"content_width",type:"text"},content_height:{name:"content_height",type:"text"},img_height:{name:"img_height",type:"text"},img_bg_color:{name:"img_bg_color",type:"text"},icon_p_t:{name:"icon_padding_top",type:"text"},icon_p_r:{name:"icon_padding_right",type:"text"},icon_p_b:{name:"icon_padding_bottom",type:"text"},icon_p_l:{name:"icon_padding_left",type:"text"},img_p_t:{name:"img_padding_top",type:"text"},img_p_r:{name:"img_padding_right",type:"text"},img_p_b:{name:"img_padding_bottom",type:"text"},img_p_l:{name:"img_padding_left",type:"text"},img_m_t:{name:"img_margin_top",type:"text"},img_m_r:{name:"img_margin_right",type:"text"},img_m_b:{name:"img_margin_bottom",type:"text"},img_m_l:{name:"img_margin_left",type:"text"},img_border_width_top:{name:"img_border_width_top",type:"text"},img_border_width_right:{name:"img_border_width_right",type:"text"},img_border_width_bottom:{name:"img_border_width_bottom",type:"text"},img_border_width_left:{name:"img_border_width_left",type:"text"},img_border_style:{name:"img_border_style",type:"select"},img_border_color:{name:"img_border_color",type:"text"},img_border_radius:{name:"img_border_radius",type:"text"},details_color:{name:"details_color",type:"text"},details_font_size:{name:"details_font_size",type:"text"},details_font_weight:{name:"details_font_weight",type:"text"},details_text_align:{name:"details_text_align",type:"hidden"},details_line_height:{name:"details_line_height",type:"text"},details_font_family:{name:"details_font_family",type:"select"},textarea_content:{name:"textarea_content",type:"textarea",attribute:"yes"},content_border_width_top:{name:"content_border_width_top",type:"text"},content_border_width_right:{name:"content_border_width_right",type:"text"},content_border_width_bottom:{name:"content_border_width_bottom",type:"text"},content_border_width_left:{name:"content_border_width_left",type:"text"},content_border_style:{name:"content_border_style",type:"select"},content_border_color:{name:"content_border_color",type:"text"},content_border_radius:{name:"content_border_radius",type:"text"},content_bg_color:{name:"content_bg_color",type:"text"},content_p_t:{name:"content_padding_top",type:"text"},content_p_r:{name:"content_padding_right",type:"text"},content_p_b:{name:"content_padding_bottom",type:"text"},content_p_l:{name:"content_padding_left",type:"text"},content_m_t:{name:"content_margin_top",type:"text"},content_m_r:{name:"content_margin_right",type:"text"},content_m_b:{name:"content_margin_bottom",type:"text"},content_m_l:{name:"content_margin_left",type:"text"},border_spacing:{name:"border_spacing",type:"text"},url1:{name:"url1",type:"text",attribute:"yes"},url2:{name:"url2",type:"text",attribute:"yes"},url3:{name:"url3",type:"text",attribute:"yes"},url4:{name:"url4",type:"text",attribute:"yes"},url5:{name:"url5",type:"text",attribute:"yes"},url6:{name:"url6",type:"text",attribute:"yes"},url7:{name:"url7",type:"text",attribute:"yes"},divider_height:{name:"divider_height",type:"text"},divider_color:{name:"divider_color",type:"text"},divider_style:{name:"divider_style",type:"select"},product_img:{name:"checkbox_option_image",type:"checkbox"},row_cellpadding:{name:"row_cellpadding",type:"checkbox"},row_cellspacing:{name:"row_cellspacing",type:"checkbox"},custom_hook_name:{name:"custom_hook_name",type:"text",attribute:"yes"},additional_css:{name:"additional_css",type:"textarea"}},ELM_FORM_PROPS={checkbox_option_image:"product_img",content_padding_top:"content_p_t",content_padding_right:"content_p_r",content_padding_bottom:"content_p_b",content_padding_left:"content_p_l",content_margin_top:"content_m_t",content_margin_right:"content_m_r",content_margin_bottom:"content_m_b",content_margin_left:"content_m_l",icon_padding_top:"icon_p_t",icon_padding_right:"icon_p_r",icon_padding_bottom:"icon_p_b",icon_padding_left:"icon_p_l",img_padding_top:"img_p_t",img_padding_right:"img_p_r",img_padding_bottom:"img_p_b",img_padding_left:"img_p_l",img_margin_top:"img_m_t",img_margin_right:"img_m_r",img_margin_bottom:"img_m_b",img_margin_left:"img_m_l",border_width_top:"b_t",border_width_right:"b_r",border_width_bottom:"b_b",border_width_left:"b_l",padding_top:"p_t",padding_right:"p_r",padding_bottom:"p_b",padding_left:"p_l",margin_top:"m_t",margin_right:"m_r",margin_bottom:"m_b",margin_left:"m_l"},DEFAULT_CSS={color:"transparent","background-color":"transparent","border-color":"transparent","background-color":"transparent","padding-top":"0px","padding-right":"0px","padding-bottom":"0px","padding-left":"0px","background-image":"none"},VISIBLE_OPTIONS={url:{name:"url",css:"block"},upload_img_url:{name:"upload_img_url",header_details:{css:"table-row"},image:{css:"inline-block"},gif:{css:"inline-block"}},url1:{name:"url1",css:"table-cell"},url2:{name:"url2",css:"table-cell"},url3:{name:"url3",css:"table-cell"},url4:{name:"url4",css:"table-cell"},url5:{name:"url5",css:"table-cell"},url6:{name:"url6",css:"table-cell"},url7:{name:"url7",css:"table-cell"}};return{initialize_tbuilder:initialize_tbuilder,open_builder_block_edit_sidebar:open_builder_block_edit_sidebar,setup_category_toggle_functions:setup_category_toggle_functions,builder_block_delete:builder_block_delete,confirm_builder_block_clone:confirm_builder_block_clone,prepare_css_functions:prepare_css_functions,clear_tbuilder:clear_tbuilder,setup_image_uploader:setup_image_uploader,template_action_add_row:template_action_add_row,template_sidebar_nav_back:template_sidebar_nav_back,remove_uploaded_image:remove_uploaded_image,remove_builder_panel_highlights:remove_builder_panel_highlights,get_style_property_name:get_style_property_name,save_additional_css:save_additional_css}}(window.jQuery,window,document),thwec_settings=function($,window,document){"use strict";function initialize_thwec(){thwec_base.setup_tiptip_tooltips(),thwec_tbuilder.initialize_tbuilder(),setup_reload_functions(),delete_template_button();$("#thwec-ajax-load-modal");$("#email_template_manager_table .thwec-template-manage-tabs").click(function(){if(!$(this).hasClass("thwec-template-manage-active")){var tab=$(this).attr("data-name"),content="manage"==tab?$("#thwec_manage_template_table tbody").html():$("#thwec_map_template_table tbody").html();$("#email_template_manager_table > tbody").html(content),"mapping"==tab?setup_select2_template_map():setup_select2_template_map(!0),$("#thwec_template_manager").find('input[name="thwec_notification_tab"]').val(tab),$(this).siblings(".thwec-template-manage-active").removeClass("thwec-template-manage-active"),$(this).addClass("thwec-template-manage-active")}}),$("#email_template_manager_table").on("click",".thwec-template-map-title",function(event){$(this).closest(".template-map-single-row").hasClass("thwec-map-toggle-active")?$(this).closest(".template-map-single-row").removeClass("thwec-map-toggle-active"):($(this).closest(".template-map-single-row").addClass("thwec-map-toggle-active"),$(this).find("h4").removeClass("thwec-map-title-decoration"))}),$("#thwec_wpml_lang").on("click",function(event){var switcher=$(this);switcher.data("lang-previous",switcher.val())}).on("change",function(event){var lang_switcher=$(this),lang=lang_switcher.val(),template=$("#template_save_name").val();if(lang&&template)if(tbuilder_pending_save()){var prev_lang=lang_switcher.data("lang-previous");prev_lang&&prev_lang!=lang&&lang_switcher.val(prev_lang),alert("Save the template before switching template.")}else initiate_lang_switch(this),$("#wpml_lang_selector").submit()})}function initiate_lang_switch(elm){$(elm).parents(".thwec-header-icons").addClass("thwec-lang-switching")}function setup_select2_template_map(destroy){destroy?$(".thwec-template-map-select2.select2-hidden-accessible").select2("destroy"):$(".thwec-template-map-select2").select2()}function send_test_mail(elm){var button=$(elm),email_id=button.siblings('input[name="test_mail_input"]').val(),validation_box=button.closest(".thwec-test-mail-modal").siblings(".thwec-action-validation-box"),email_validation=test_mail_validations(email_id);if(email_validation.valid){validation_box.html(""),set_preview_template_content(!1);var test_mail_data=$("#thwec_tbuilder_editor_preview").html(),css=$("#thwec_template_css").html();css+=$("#thwec_template_css_preview_override").html();prepare_test_email_ajax(test_mail_data,css,$("#thwec_template_css_additional_css").length?$("#thwec_template_css_additional_css").html():"",email_id,validation_box)}else{var error_msg="";$.each(email_validation.errors,function(key,value){error_msg+=prepare_validation_html(value,email_validation.valid)}),validation_box.html(error_msg)}}function test_mail_validations(mail_id){var validation_set={},error_msg=[];validation_set.valid=!0;var builder_valid=!0,email_valid=!0,split_pattern=mail_id.split("@");if(split_pattern){var validation1=(split_pattern[0],split_pattern[1]);if(""!=validation1&&null!=validation1){var valid_split=validation1.split("."),validation21=(valid_split[0],valid_split[1]);null!=validation21&&""!=validation21?email_valid=!0:(email_valid=!1,error_msg.push(TEST_MAIL_VALIDATE_NOTICE))}else email_valid=!1,error_msg.push(TEST_MAIL_VALIDATE_NOTICE)}return 0==$("#tb_temp_builder").find(".builder-block").length&&(error_msg.push("Add contents to the builder"),builder_valid=!1),validation_set.valid=!(!email_valid||!builder_valid),validation_set.errors=error_msg,validation_set}function prepare_test_email_ajax(mail_data,mail_css,add_css,mail_id,msg_box){var template_ajax_load=$("#thwec-ajax-load-modal"),test_data={action:"thwec_save_email_template",thwec_action_index:"settings",test_mail_data:mail_data,test_mail_css:mail_css,test_mail_add_css:add_css,test_mail_id:mail_id};$.ajax({type:"POST",url:ajaxurl,data:test_data,beforeSend:function(){template_ajax_load.addClass("thwec-ajax-loading")},success:function(data){"success"==data&&msg_box.html(prepare_validation_html("Email sent successfully",!0))},complete:function(){template_ajax_load.removeClass("thwec-ajax-loading")},error:function(){alert("error")}})}function create_new_template(){location.reload(),prepare_page_reload()}function setup_reload_functions(){window.addEventListener("beforeunload",function(event){prepare_page_reload()})}function prepare_page_reload(){tbuilder_pending_save()&&(event.returnValue="o/")}function tbuilder_pending_save(){var builder_obj=$("#tb_temp_builder"),block_length=builder_obj.find(".builder-block").length,data_track=builder_obj.attr("data-track-save"),data_global=builder_obj.attr("data-global-id"),data_css=builder_obj.attr("data-css-change"),data_sidebar=builder_obj.attr("data-sidebar-change");return builder_obj.length>0&&block_length>0&&data_track!=data_global||("false"==data_css||"false"==data_sidebar)}function prepare_validation_html(message,valid){var html="";return html+='<p class="'+(valid?"thwec-validation-success":"thwec-validation-failed")+'">'+message+"</p>"}function performTemplateNameValidations(tname,template_builder,popup){var validation_box=$("#thwec_builder_header_action_box .thwec-action-validation-box"),template_name_valid=!0,blank_builder_valid=!0,block_length=template_builder.find(".thwec-block").length,hook_length=template_builder.find(".hook-code").length;validation_box.html("");var input_validation=custom_tname_validation(tname,"Template");return template_name_valid=0===input_validation.length,blank_builder_valid=block_length>0||hook_length>0,validation_box.siblings(".thwec-validation-special-char").removeClass("thwec-validation-failed"),blank_builder_valid?template_name_valid||$.each(input_validation,function(key,value){"special_char"==value.error?validation_box.siblings(".thwec-validation-special-char").addClass("thwec-validation-failed"):validation_box.append(prepare_validation_html(value.message,template_name_valid))}):popup?validation_box.html(prepare_validation_html("Add elements to save the template",blank_builder_valid)):alert("Add elements to save the template"),template_name_valid&&blank_builder_valid}function initiateTemplateSave(elm,tname,popup){var template_builder=$("#tb_temp_builder"),tname=$("#template_save_name").val(),disp_name_input=$(elm).siblings(".thwec-template-display-name"),disp_name=disp_name_input.val();if(tname&&disp_name){if(tname!=disp_name){var result=confirm("You have changed the template name. Do you want to create a duplicate ?");if(!result)return;T_DUPLICATE=!0,tname=disp_name}}else tname?disp_name||disp_name_input.val(tname):tname=disp_name;if(performTemplateNameValidations(tname,template_builder,popup)){var tcontent=$("#template_drag_and_drop").innerHTML,tcss=$("#thwec_template_css").html(),json_tree=create_json_layout_structure();template_builder.attr("data-track-save",template_builder.attr("data-global-id")),prepare_template_content(tname,tcontent,tcss,json_tree),template_builder.attr("data-css-change","true"),template_builder.attr("data-sidebar-change","true")}}function create_json_layout_structure(){var layer_data=$(".thwec-tbuilder-elm-wrapper").find(".thwec-sidebar-config-elm-layers .thwec-builder-elm-layers"),row_struct={},row_array=[];return layer_data.find("> .rows.panel-builder-block").each(function(index,el){var row_data={},col_array=[];$(this).find("> .column-set > .columns.panel-builder-block").each(function(index,el){var col_data={},elm_array=[];$(this).find("> .element-set > .panel-builder-block").each(function(index,el){var elm_data={};if($(this).hasClass("rows")){var data=create_json_rows($(this));elm_array.push(data)}else if($(this).hasClass("elements"))elm_data.data_id=$(this).attr("id"),elm_data.data_type="element",elm_data.data_name=$(this).find(".thwec-block-settings .template-action-edit").attr("data-icon-attr"),elm_data.data_css=$("#tb_"+$(this).attr("id")).attr("data-css-props"),elm_data.data_text=$("#tb_"+$(this).attr("id")).attr("data-text-props"),elm_data.child=$(this).find(".element-name").text(),elm_data.data_css_compat=$("#tb_"+$(this).attr("id")).attr("data-css-compat"),elm_array.push(elm_data);else{elm_data.data_id=$(this).attr("id"),elm_data.data_type="hook";var hook_names=$(this).find(".hook-name").text(),hook_suffix="Downloadable Product"==hook_names?"table":"hook";hook_names=hook_names+"_"+hook_suffix,elm_data.data_name=hook_names.toLowerCase().replace(/\s+/g,"_"),elm_data.child=$(this).find(".hook-name").text(),elm_array.push(elm_data)}}),col_data.data_id=$(this).attr("id"),col_data.data_type="column",col_data.data_name=$(this).find(".thwec-block-settings .template-action-edit").attr("data-icon-attr"),col_data.data_css=$("#tb_"+$(this).attr("id")).attr("data-css-props"),col_data.child=elm_array,col_array.push(col_data)}),row_data.data_id=$(this).attr("id"),row_data.data_type="row",row_data.data_name=$(this).find(".thwec-block-settings .template-action-edit").attr("data-icon-attr"),row_data.data_css=$("#tb_"+$(this).attr("id")).attr("data-css-props"),row_data.data_text=$("#tb_"+$(this).attr("id")).attr("data-text-props"),row_data.data_count=$("#tb_"+$(this).attr("id")).attr("data-column-count"),row_data.child=col_array,row_array.push(row_data)}),row_struct.row=row_array,row_struct.data_id="temp_builder",row_struct.data_type="builder",row_struct.track_save=$("#tb_temp_builder").attr("data-global-id"),
row_struct.data_css=$("#tb_temp_builder").attr("data-css-props"),JSON.stringify(row_struct)}function create_json_rows(elm){var row_struct={},row_data={},row_array=[],col_array=[];return elm.find("> .column-set > .columns.panel-builder-block").each(function(index,el){var col_data={},elm_array=[];$(this).find("> .element-set > .panel-builder-block").each(function(index,el){var elm_data={};if($(this).hasClass("rows")){var data=create_json_rows($(this));elm_array.push(data)}else if($(this).hasClass("elements"))elm_data.data_id=$(this).attr("id"),elm_data.data_type="element",elm_data.data_name=$(this).find(".thwec-block-settings .template-action-edit").attr("data-icon-attr"),elm_data.data_css=$("#tb_"+$(this).attr("id")).attr("data-css-props"),elm_data.data_text=$("#tb_"+$(this).attr("id")).attr("data-text-props"),elm_data.child=$(this).find(".element-name").text(),elm_data.data_css_compat=$(this).attr("data-css-compat"),elm_array.push(elm_data);else{elm_data.data_id=$(this).attr("id"),elm_data.data_type="hook";var hook_names=$(this).find(".hook-name").text(),hook_suffix="Downloadable Product"==hook_names?"table":"hook";hook_names=hook_names+"_"+hook_suffix,elm_data.data_name=hook_names.toLowerCase().replace(/\s+/g,"_"),elm_data.child=$(this).find(".hook-name").text(),elm_array.push(elm_data)}}),col_data.data_id=$(this).attr("id"),col_data.data_type="column",col_data.data_name=$(this).find(".thwec-block-settings .template-action-edit").attr("data-icon-attr"),col_data.child=elm_array,col_data.data_css=$("#tb_"+$(this).attr("id")).attr("data-css-props"),col_array.push(col_data)}),row_data.data_id=elm.attr("id"),row_data.data_type="row",row_data.data_name=elm.find(".thwec-block-settings .template-action-edit").attr("data-icon-attr"),row_data.data_css=$("#tb_"+elm.attr("id")).attr("data-css-props"),row_data.data_text=$("#tb_"+elm.attr("id")).attr("data-text-props"),row_data.data_count=$("#tb_"+elm.attr("id")).attr("data-column-count"),row_data.child=col_array,row_array.push(row_data),row_struct.row=row_array,row_struct}function custom_tname_validation(tname,dependend){var validate=[],validation_set=[];return""==tname&&(validate.status=!1,validate.validate_flag="name",validate.message=dependend+" name is empty",validation_set.push(validate)),"Hook"==dependend?0==/^[a-zA-Z_]*$/.test(tname)&&(validate.status=!1,validate.validate_flag=!1,validate.message='Use only letters ([a-z],[A-Z]) and underscores ("_") for template name',validation_set.push(validate)):"Template"==dependend&&(0==/^[a-zA-Z0-9-_ ]*$/.test(tname)&&(validate=[],validate.status=!1,validate.error="special_char",validate.validate_flag=!1,validate.message='Use only letters ([a-z],[A-Z]), digits ([0-9]), hyphen ("-") and underscores ("_") for template name',validation_set.push(validate)),tname.length>100&&(validate=[],validate.status=!1,validate.validate_flag=!1,validate.message="Template name cannot be longer than 100 characters",validation_set.push(validate)),1==/^([_|-]+)$/.test(tname)&&(validate=[],validate.status=!1,validate.validate_flag=!1,validate.message="Template name must contain atleast one alphabet or number.",validation_set.push(validate)),(tname.startsWith("_")||tname.startsWith("-"))&&(validate=[],validate.status=!1,validate.validate_flag=!1,validate.message="Template name must begin with an Alphabet or number",validation_set.push(validate))),validation_set}function prepare_template_content(name,content,css,json_tree){update_template_name(name);set_preview_template_content(!0);var template_data=$("#thwec_tbuilder_editor_preview").html(),content_raw=$(".thwec-tbuilder-wrapper").wrap("<p/>").parent().html();$(".thwec-tbuilder-wrapper").unwrap(),ajax_call_save_data(name,content_raw,template_data,css+$("#thwec_template_css_preview_override").html(),$("#thwec_template_css_additional_css").length?$("#thwec_template_css_additional_css").html():"",json_tree)}function update_template_name(name){$("#template_save_name").attr("value",name);var format_name=name.replace(/\s+/g,"_").toLowerCase();if(name){var template_meta=$(".thwec-header-icons-holder.thwec-meta-display-box");template_meta.removeClass("thwec-empty-name"),template_meta.find(".text-content").html(name)}format_name&&$("#template_format_name").val(format_name)}function ajax_call_save_data(name,content_raw,content_cleaned,css_cleaned,additional_css,json_tree){var template_ajax_load=$("#thwec-ajax-load-modal"),sample_data={action:"thwec_save_email_template",thwec_action_index:"settings",template_name:name,template_edit_data:content_raw,template_render_data:content_cleaned,template_render_css:css_cleaned,template_add_css:additional_css,template_json_tree:json_tree,template_lang:$("#thwec_wpml_lang").val()};$.ajax({type:"POST",url:ajaxurl,data:sample_data,beforeSend:function(){template_ajax_load.addClass("thwec-ajax-loading"),$("#thwec_builder_save_messages").html("").removeClass("thwec-show-save thwec-save-success"),$("#thwec-template-builder-wrapper").addClass("thwec-template-save-active")},success:function(data){var msg="Template saved";T_DUPLICATE&&(T_DUPLICATE=!1,msg="Template Duplicate created successfully"),$("#thwec_builder_save_messages").html(msg).addClass("thwec-show-save thwec-save-success"),setTimeout(function(){$("#thwec_builder_save_messages").removeClass("thwec-show-save thwec-save-success")},3e3)},complete:function(){template_ajax_load.removeClass("thwec-ajax-loading"),close_modal(),$("#thwec-template-builder-wrapper").removeClass("thwec-template-save-active")},error:function(){$("#thwec_builder_save_messages").html("Something went wrong").addClass("thwec-show-save thwec-save-error"),setTimeout(function(){$("#thwec_builder_save_messages").removeClass("thwec-show-save thwec-save-error")},3e3)}})}function toggle_builder_preview_tab(elm){var tab_elm=$(elm),tab=tab_elm.data("tab"),active_tab_elm=tab_elm.closest(".thwec-header-icons").find(".active-tab"),active_tab=active_tab_elm.data("tab");if(thwec_tbuilder.remove_builder_panel_highlights(),tab!=active_tab){if("builder"==tab)switch_to_builder();else if("preview"==tab){if(!($("#tb_temp_builder").find(".thwec-block").length>0))return void alert("Nothing to Preview");switch_to_preview()}active_tab_elm.removeClass("active-tab"),tab_elm.addClass("active-tab")}}function switch_to_preview(){hide_builder_sidebar();set_preview_template_content(!1)}function switch_to_builder(){$("#thwec-template-builder-wrapper").removeClass("thwec-preview-active"),$("#wpfooter").show(),$("#thwec_tbuilder_editor_preview").hide()}function hide_builder_sidebar(){$("#thwec-template-builder-wrapper").addClass("thwec-preview-active"),$("#wpfooter").hide(),$("#thwec_tbuilder_editor_preview").show()}function prepare_custom_hook_function(block_elm,block_name){"custom_hook"==block_name&&(block_elm.replaceWith('[WECM_CUSTOM_HOOK name="'+block_elm.find(".hook-text").text()+'"]'),block_elm.attr("class","thwec-custom-hook"),block_elm.removeAttr("data-block-name"),block_elm.removeAttr("data-text-props"),block_elm.removeAttr("id"))}function set_preview_template_content(show_hooks){var preview_html=$("#tb_temp_builder").clone(!1);clean_preview_panel(preview_html),preview_html.find(".btn-add-element").remove(),preview_html.find(".builder-block").each(function(index,el){var block_name=$(this).data("block-name");if(show_hooks?(set_contents_hooks_and_data($(this),block_name),prepare_custom_hook_function($(this),block_name)):prepare_content_hooks_for_test_mail($(this),block_name),$(this).attr("id")){var id=$(this).attr("id");id=id.replace("tb_","tp_"),$(this).attr("id",id)}$(this).hasClass("thwec-row")&&$(this).find(" tbody> tr > .thwec-columns").each(function(index,el){var id=$(this).attr("id");id=id.replace("tb_","tp_"),$(this).attr("id",id)})}),preview_html.find(".builder-block").removeClass("builder-block"),preview_html.find("[data-css-props]").each(function(index,el){$(this).removeAttr("data-css-props"),$(this).attr("data-text-props")&&$(this).removeAttr("data-text-props")}),preview_html.removeAttr("data-css-props"),preview_html.removeAttr("data-global-id"),preview_html.removeAttr("data-track-save"),preview_html.removeAttr("data-css-change"),$("#thwec_tbuilder_editor_preview").html(preview_html)}function clean_preview_panel(elm){elm.find("p.hook-code").each(function(index,el){$(this).removeAttr("id")}),elm.attr("id",elm.attr("id").replace("tb_","tp_")),elm.removeClass("thwec-dropable sortable ui-sortable ui-droppable"),elm.find(".thwec-icon-panel").remove(),elm.find(".thwec-columns .dashicons-edit").remove(),elm.find('input[type="hidden"]').remove(),elm.find(".thwec-columns").css("min-height","0"),elm.find(".ui-sortable").removeClass("ui-sortable ui-droppable")}function prepare_content_hooks_for_test_mail(block_elm,block_name){"order_details"==block_name&&(block_elm.find(".item-loop-start").remove(),block_elm.find(".item-loop-end").remove(),block_elm.find(".order-total-loop-start").remove(),block_elm.find(".order-total-loop-end").remove())}function ot_loop_end_html(block_elm){var inline_css="",styles=block_elm.find("tr.order-total-loop-end").attr("data-ot-css");return styles&&(styles=$.parseJSON(styles),$.each(styles,function(key,val){var property=thwec_tbuilder.get_style_property_name(key);property&&(inline_css+=property+":"+val+";")})),"[WECM_ORDER_TD_CSS styles='"+inline_css+"']"}function set_contents_hooks_and_data(block_elm,block_name){if("order_details"==block_name){var order_heading=block_elm.find(".thwec-order-heading .order-title").html();block_elm.find(".thwec-order-heading").html('[WECM_ORDER_T_HEAD text="'+order_heading+'"]'),block_elm.find(".thwec-order-table .woocommerce_order_item_class-filter2").remove(),block_elm.find(".thwec-order-table .order-footer .order-footer-row:gt(0)").remove(),block_elm.find(".thwec-order-item-img").hasClass("show-product-img")?block_elm.find(".order-item").html("{order_items_img}"):block_elm.find(".order-item").html("{order_items}"),block_elm.find(".order-item-qty").html("{order_items_qty}"),block_elm.find(".order-item-price").html("{order_items_price}"),block_elm.find(".order-total-label").html("{total_label}"),block_elm.find(".order-total-value").html("{total_value}"),block_elm.find(".order-head").each(function(index,el){$(this).html("{Order_"+$(this).text()+"}")});block_elm.attr("id");block_elm.find("tr.order-total-loop-end").replaceWith(ot_loop_end_html(block_elm))}"billing_address"==block_name&&calculate_hook_position(block_elm,"{billing_address}","thwec-billing-body",!1,!1),"shipping_address"==block_name&&(calculate_hook_position(block_elm,"{shipping_address}","thwec-shipping-body",!1,!1),additional_support_functions(block_elm,block_name)),"customer_address"==block_name&&(calculate_hook_position(block_elm,"{customer_hook}",null,!0,!1),calculate_hook_position(block_elm,"{customer_address}","thwec-customer-body",!1,!1))}function additional_support_functions($elm,$name){if("shipping_address"==$name){var shipping_table=$elm.find("> tbody > tr > td");shipping_table.prepend("<span>{thwec_before_shipping_address}</span>"),shipping_table.append("<span>{thwec_after_shipping_address}</span>")}}function calculate_hook_position($obj,$hook_name,$class_name,$control,$position){var elm_blk=$obj.closest(".thwec-element-block"),elm_col=$obj.closest(".thwec-columns"),row_col=$obj.closest(".column_layout"),insert="";$control?(insert=elm_blk.siblings().length?elm_blk:elm_blk.closest(".column-padding").length?elm_col:row_col,$position?$("<span>"+$hook_name+"</span>").insertAfter(insert):$("<span>"+$hook_name+"</span>").insertBefore(insert)):$obj.find("."+$class_name).html("<span>"+$hook_name+"</span>")}function edit_template_change_listner(elm){var form=$("#thwec_edit_template_form");if(""==thwec_base.get_property_field_value(form,"select","edit_template"))alert("Select a template to edit"),event.preventDefault();else{var optgroup=get_optgroup_label(form);form.find('input[name="i_template_type"]').length?form.find('input[name="i_template_type"]').val(optgroup):form.append('<input type="hidden" name="i_template_type" value="'+optgroup+'">')}}function delete_template_button(){$("#delete_template").click(function(event){var form=$("#thwec_edit_template_form");""==thwec_base.get_property_field_value(form,"select","edit_template")?(alert("Select template to delete"),event.preventDefault()):"sample"==get_optgroup_label(form)?(alert("Sample templates cannot be deleted"),event.preventDefault()):confirm("Delete the selected template ?")||event.preventDefault()})}function get_optgroup_label(form){var optgroup=form.find('select[name="i_edit_template"] :selected').closest("optgroup").attr("label");return optgroup="Sample Templates"==optgroup?"sample":"user"}function template_map_validation(event,elm){return!1}function open_modal(elm,flag){var content=$("#thwec_modal_"+flag).html(),modal_box=$("#thwec_builder_header_action_box"),template_name=$("#template_save_name").val();thwec_tbuilder.remove_builder_panel_highlights(),modal_box.find(".content-box").html(content),template_name&&modal_box.find(".thwec-template-display-name").val(template_name),modal_box.addClass("thwec-modal-active")}function close_modal(elm){$("#thwec_builder_header_action_box").removeClass("thwec-modal-active")}function save_template_event(elm){var template_name=$("#template_save_name").val();template_name?initiateTemplateSave(elm,template_name,!1):open_modal(elm,"template_name")}function edit_template_name(elm){open_modal(elm,"template_name")}function map_form_toggle(elm){var button=$(elm),button_class=button.attr("class"),map_table=$("#email_template_manager_table .thpladmin-form-email-notification-table");"thwec-close-all"==button_class?(map_table.find(".thwec-map-toggle-active").removeClass("thwec-map-toggle-active"),button.text("Expand all"),button.removeClass("thwec-close-all").addClass("thwec-open-all")):"thwec-open-all"==button_class&&(map_table.find(".template-map-single-row ").addClass("thwec-map-toggle-active"),button.text("Collpase all"),button.removeClass("thwec-open-all").addClass("thwec-close-all"))}function delete_template(){thwec_var.wpml_active&&!thwec_var.template_filter&&(confirm("All created translations of this template will be deleted. Proceed ?")||event.preventDefault())}var TEST_MAIL_VALIDATE_NOTICE="<span>Please enter a valid email id</span>",T_DUPLICATE=!1;return $(function(){$("#thwec_settings_fields_form");initialize_thwec()}),{initiateTemplateSave:initiateTemplateSave,custom_tname_validation:custom_tname_validation,send_test_mail:send_test_mail,create_new_template:create_new_template,edit_template_change_listner:edit_template_change_listner,template_map_validation:template_map_validation,open_modal:open_modal,close_modal:close_modal,save_template_event:save_template_event,edit_template_name:edit_template_name,map_form_toggle:map_form_toggle,toggle_builder_preview_tab:toggle_builder_preview_tab,delete_template:delete_template}}(window.jQuery,window,document);